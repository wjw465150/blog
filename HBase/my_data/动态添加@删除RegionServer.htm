<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>动态添加@删除RegionServer</title>
<meta name="GENERATOR" content="WinCHM">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style>
html,body { 
	/* Default Font */
	font-family: Arial, Helvetica, sans-serif;
	font-size: 11pt;
}
</style>

</head>

<body>
<H3 class="post-title entry-title" 
style="WHITE-SPACE: normal; WORD-SPACING: 0px; POSITION: relative; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); FONT: 30px Arial, Tahoma, Helvetica, FreeSans, sans-serif; MARGIN: 0.75em 0px 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px; font-stretch: normal" 
itemprop="name">Adding/Removing RegionServers dynamically from a 
Fully-Distributed HBase cluster</H3>
<DIV class=post-header 
style="WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); FONT: 12px/1.6 Georgia, Utopia, 'Palatino Linotype', Palatino, serif; MARGIN: 0px 0px 1.5em; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">
<DIV class=post-header-line-1></DIV></DIV>
<DIV id=post-body-1453952357545759154 class="post-body entry-content" 
style="WIDTH: 730px; WHITE-SPACE: normal; WORD-SPACING: 0px; POSITION: relative; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); FONT: 13px/1.4 Georgia, Utopia, 'Palatino Linotype', Palatino, serif; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px" 
itemprop="description articleBody">
<DIV style="TEXT-ALIGN: left" dir=ltr trbidi="on"><BR>
<DIV class=MsoNormal style="TEXT-ALIGN: center" align=center><BR></DIV>
<DIV class=MsoNormal style="MARGIN-BOTTOM: 0pt"><SPAN 
style="FONT-SIZE: large; FONT-FAMILY: Times, 'Times New Roman', serif"><B>Adding 
a RegionServer dynamically to a running HBase Cluster<?xml:namespace prefix = 
"o" /><o:p></o:p></B></SPAN></DIV>
<DIV class=MsoNormal style="MARGIN-BOTTOM: 0pt"><BR></DIV>
<DIV class=MsoNormal style="MARGIN-BOTTOM: 0pt"><SPAN 
style="FONT-SIZE: large; FONT-FAMILY: Times, 'Times New Roman', serif">Being 
able to add RegionServers dynamically without bringing down the entire cluster 
is quite a significant requirement and at the same time damn 
easy.<o:p></o:p></SPAN></DIV>
<DIV class=MsoNormal style="MARGIN-BOTTOM: 0pt"><BR></DIV>
<DIV class=MsoNormal style="MARGIN-BOTTOM: 0pt"><SPAN 
style="FONT-SIZE: large; FONT-FAMILY: Times, 'Times New Roman', serif">Step 1: 
Edit $HBASE_HOME/conf/regionservers on the Master node and add the new 
address.<o:p></o:p></SPAN></DIV>
<DIV class=MsoNormal style="MARGIN-BOTTOM: 0pt"><BR></DIV>
<DIV class=MsoNormal style="MARGIN-BOTTOM: 0pt"><SPAN 
style="FONT-SIZE: large; FONT-FAMILY: Times, 'Times New Roman', serif">Step 2: 
Setup the new node with needed software, permissions.<o:p></o:p></SPAN></DIV>
<DIV class=MsoNormal style="MARGIN-BOTTOM: 0pt"><BR></DIV>
<DIV class=MsoNormal style="MARGIN-BOTTOM: 0pt"><SPAN 
style="FONT-SIZE: large; FONT-FAMILY: Times, 'Times New Roman', serif">Step 3: 
On that node run<o:p></o:p></SPAN></DIV>
<DIV class=MsoNormal style="MARGIN-BOTTOM: 0pt"><SPAN 
style="FONT-SIZE: large; FONT-FAMILY: Times, 'Times New Roman', serif"><B>$HBASE_HOME/bin/hbase-daemon.sh 
start regionserver<o:p></o:p></B></SPAN></DIV>
<DIV class=MsoNormal style="MARGIN-BOTTOM: 0pt"><SPAN 
style="FONT-SIZE: large; FONT-FAMILY: Times, 'Times New Roman', serif">Confirm 
it worked by looking at the Master's web UI or in that region server's 
log.<o:p></o:p></SPAN></DIV>
<DIV class=MsoNormal style="MARGIN-BOTTOM: 0pt"><BR></DIV>
<DIV class=MsoNormal style="MARGIN-BOTTOM: 0pt"><SPAN 
style="FONT-SIZE: large; FONT-FAMILY: Times, 'Times New Roman', serif">That’s 
it. You’re done.<o:p></o:p></SPAN></DIV>
<DIV class=MsoNormal style="MARGIN-BOTTOM: 0pt"><BR></DIV>
<DIV class=MsoNormal style="MARGIN-BOTTOM: 0pt"><SPAN 
style="FONT-SIZE: large; FONT-FAMILY: Times, 'Times New Roman', serif"><B>Removing/Decommissioning 
a RegionServer dynamically from a running HBase 
Cluster<o:p></o:p></B></SPAN></DIV>
<DIV class=MsoNormal style="MARGIN-BOTTOM: 0pt"><BR></DIV>
<DIV class=MsoNormal style="MARGIN-BOTTOM: 0pt"><SPAN 
style="FONT-SIZE: large; FONT-FAMILY: Times, 'Times New Roman', serif">Just as 
significant as being able to add a RegionServer to an HBase Cluster dynamically 
is essential, just that important it is to be able to remove one. 
&nbsp;<o:p></o:p></SPAN></DIV>
<DIV class=MsoNormal style="MARGIN-BOTTOM: 0pt"><SPAN 
style="FONT-SIZE: large; FONT-FAMILY: Times, 'Times New Roman', serif">And you 
can be happy that it is just a matter of two steps.<o:p></o:p></SPAN></DIV>
<DIV class=MsoNormal style="MARGIN-BOTTOM: 0pt"><BR></DIV>
<DIV class=MsoNormal style="MARGIN-BOTTOM: 0pt"><SPAN 
style="FONT-SIZE: large; FONT-FAMILY: Times, 'Times New Roman', serif">Step 1: 
On the node to be removed run<o:p></o:p></SPAN></DIV>
<DIV class=MsoNormal style="MARGIN-BOTTOM: 0pt"><SPAN 
style="FONT-SIZE: large; FONT-FAMILY: Times, 'Times New Roman', serif">$HBASE_HOME/bin/hbase-daemon.sh 
stop regionserver<o:p></o:p></SPAN></DIV>
<DIV class=MsoNormal style="MARGIN-BOTTOM: 0pt"><BR></DIV>
<DIV class=MsoNormal style="MARGIN-BOTTOM: 0pt"><SPAN 
style="FONT-SIZE: large; FONT-FAMILY: Times, 'Times New Roman', serif">Step 2: 
Edit $HBASE_HOME/conf/regionservers on the Master node and remove the address of 
the particular node being removed.<o:p></o:p></SPAN></DIV>
<DIV class=MsoNormal style="MARGIN-BOTTOM: 0pt"><BR></DIV>
<DIV class=MsoNormal style="MARGIN-BOTTOM: 0pt"><SPAN 
style="FONT-SIZE: large; FONT-FAMILY: Times, 'Times New Roman', serif">You can 
check the UI to ensure the node has been removed from the 
cluster.<o:p></o:p></SPAN></DIV>
<DIV class=MsoNormal style="MARGIN-BOTTOM: 0pt"><BR></DIV>
<DIV class=MsoNormal style="MARGIN-BOTTOM: 0pt"><SPAN 
style="FONT-SIZE: large; FONT-FAMILY: Times, 'Times New Roman', serif"><B>Be 
careful about your data<o:p></o:p></B></SPAN></DIV>
<DIV class=MsoNormal style="MARGIN-BOTTOM: 0pt"><BR></DIV>
<DIV class=MsoNormal style="MARGIN-BOTTOM: 0pt"><SPAN 
style="FONT-SIZE: large; FONT-FAMILY: Times, 'Times New Roman', serif">Ensure to 
disable the Load Balancer before Decommissioning/Removing a node. This is 
because there might be contention between the Master recovering from the loss of 
the recently removed RegionServer and the running Load Balancer. Hence, it 
important to stop the load balancer(if running)before removing the regionserver 
from the cluster.<o:p></o:p></SPAN></DIV>
<DIV class=MsoNormal style="MARGIN-BOTTOM: 0pt"><BR></DIV>
<DIV class=MsoNormal style="MARGIN-BOTTOM: 0pt"><SPAN 
style="FONT-SIZE: large; FONT-FAMILY: Times, 'Times New Roman', serif">Also, in 
Apache HBase 0.90.2, there is an added facility for having a node gradually shed 
its load and then shutdown itself down by using the graceful_stop.sh script as 
follows:<o:p></o:p></SPAN></DIV>
<DIV class=MsoNormal style="MARGIN-BOTTOM: 0pt"><BR></DIV>
<DIV class=MsoNormal style="MARGIN-BOTTOM: 0pt"><SPAN 
style="FONT-SIZE: large; FONT-FAMILY: Times, 'Times New Roman', serif"><B>$HBASE_HOME/bin/graceful_stop.sh 
HOSTNAME<o:p></o:p></B></SPAN></DIV>
<DIV class=MsoNormal style="MARGIN-BOTTOM: 0pt"><BR></DIV>
<DIV class=MsoNormal style="MARGIN-BOTTOM: 0pt"><SPAN 
style="FONT-SIZE: large; FONT-FAMILY: Times, 'Times New Roman', serif">where 
HOSTNAME is the host carrying the RegionServer you would 
remove/decommission.</SPAN></DIV></DIV></DIV></body>
</html>
