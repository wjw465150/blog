<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html xmlns="http://www.w3.org/1999/xhtml"><head profile="http://gmpg.org/xfn/11"><title>sed 简明教程</title><!-- Source is http://coolshell.cn/articles/9104.html -->



	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" >
	<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">

	
	<link rel="alternate" type="application/rss+xml" title="RSS 2.0 - 所有文章" href="http://coolshell.cn/feed" >
	<link rel="alternate" type="application/rss+xml" title="RSS 2.0 - 所有评论" href="http://coolshell.cn/comments/feed" >
	<link rel="pingback" href="http://coolshell.cn/xmlrpc.php" ><!-- style START --><!-- default style -->
<STYLE type=text/css media=screen>@import url( index_files/style.css );</STYLE>
<!-- for translations -->
	
			<LINK rel=stylesheet type=text/css href="index_files/chinese.css" media=screen ><!-- style END --><!-- script START -->
		
	

	
	<script type="text/javascript" src="index_files/base.js" >
	<script type="text/javascript" src="index_files/menu.js" /><!-- script END -->
	

	<link rel="alternate" type="application/rss+xml" title="酷壳 - CoolShell.cn » sed 简明教程 评论 Feed" href="http://coolshell.cn/articles/9104.html/feed" />
<link rel="stylesheet" id="wp-postratings-css" href="index_files/postratings-css.css" type="text/css" media="all" />
<link rel="stylesheet" id="wp-pagenavi-css" href="index_files/pagenavi-css.css" type="text/css" media="all" />
<script type="text/javascript" src="index_files/jquery.js" />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://coolshell.cn/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://coolshell.cn//wp-includes/wlwmanifest.xml" /> 
<link rel="prev" title="AWK 简明教程" href="http://coolshell.cn/articles/9070.html" />
<link rel="next" title="并发框架Disruptor译文" href="http://coolshell.cn/articles/9169.html" />
<meta name="generator" content="WordPress 3.5.1" />
<link rel= "shortlink"href="http://coolshell.cn/?p=9104" /><!-- All in One SEO Pack 1.6.15.3 by Michael Torbert of Semper Fi Web Design[326,385] -->


<meta name="keywords" content="linux,sed,unix" />
<link rel="canonical" href="http://coolshell.cn/articles/9104.html" /><!-- /all in one seo pack -->

	<link href="index_files/SyntaxHighlighter.css" type="text/css" rel="stylesheet" /><!-- Start of StatCounter Code -->
		
	<script type="text/javascript">
	<!-- 
		var sc_project=8326668; 
		var sc_security="cccb27f2"; 
		var sc_invisible=1;
	//-->
	</script>
	<script type="text/javascript" src="index_files/counter_xhtml.js" >
<link rel="stylesheet" href="index_files/plain.css" /><meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.5" /><meta itemprop="name" content="sed 简明教程" /><meta itemprop="description" content="awk于1977年出生，今年36岁本命年，sed比awk大2-3岁，awk就像林妹妹，sed就是宝玉哥哥了。所以&nbsp;林妹妹跳了个Topless，他的哥哥sed坐不住了，也一定要出来抖一抖。

sed全名叫stream editor，流编辑器，用程序的方式来编辑文本，相当的hacker啊。sed基本上就是玩正则模式匹配，所以，玩sed的人，正则表达式一般都比较强。

同样，本篇文章不会说sed..." /><meta itemprop="url" content="http://coolshell.cn/articles/9104.html" /><meta itemprop="bestRating" content="5" /><meta itemprop="ratingValue" content="4.81" /><meta itemprop="ratingCount" content="27" /></head><noscript /><body><div class="statcounter"><a title="web analytics" href="http://statcounter.com/"><img class="statcounter" src="http://c.statcounter.com/8326668/0/cccb27f2/1/" alt="web analytics" /></a></div>	
	<!-- End of StatCounter Code -->
<script type="text/javascript">
	window._wp_rp_static_base_url = 'http://dtmvdvtzf8rz0.cloudfront.net/static/';
	window._wp_rp_wp_ajax_url = "http://coolshell.cn/wp-admin/admin-ajax.php";
	window._wp_rp_plugin_version = '2.5';
	window._wp_rp_post_id = '9104';
	window._wp_rp_num_rel_posts = '8';
	window._wp_rp_blog_id = '9793678';
	window._wp_rp_ajax_img_src_url = 'http://t.related-posts.com/pageview/?';
	window._wp_rp_thumbnails = false;
	window._wp_rp_post_title = 'sed+%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B';
	window._wp_rp_post_tags = ['linux', 'sed', 'unix', 'unix%2Flinux', '%3F%3F%3F%3F', 'betti', 'hao', 'gt', 'sg', 'img', 'shell', 'sed', 'chen', 'georg', 'frank', 'goat', 'fish', 'dog', 'cat', 'alt'];
	window._wp_rp_promoted_content = true;
	window._wp_rp_traffic_exchange = false;
</script>
<script type="text/javascript" src="index_files/pageview.js" async="" >


<!-- Start Of Script Generated By WP-PostViews -->
<script type="text/javascript">
/* < ![CDATA[
*/jQuery.ajax({type:'GET',url:'http://coolshell.cn/wp-admin/admin-ajax.php',data:'postviews_id=9104&action=postviews',cache:false});/* ]]> */
</script>
<!-- End Of Script Generated By WP-PostViews --><!-- wrap START --><!-- container START --><!-- header START --><!-- header END --><!-- navigation START --><!-- navigation END --><!-- content START --><!-- main START -->
<META name=GENERATOR content="MSHTML 11.00.9600.18015"></head>
<BODY>
<div id="wrap">
<div id="container">
<div id="content">
	<div id="main"><br >
<div style="OUTLINE-WIDTH: 2px !important; OUTLINE-STYLE: dashed !important; OUTLINE-COLOR: navy !important" class   ="post" id="post-9104">
		<h2>sed 简明教程</h2><br >
<div class="content">
			<p><IMG class="alignright wp-image-9126" alt="" src="index_files/sed-superman.png" width=216 height=216 >awk于1977年出生，今年36岁本命年，sed比awk大2-3岁，awk就像林妹妹，sed就是宝玉哥哥了。所以&nbsp;<a title="AWK 简明教程" href="http://coolshell.cn/articles/9070.html" target="_blank">林妹妹跳了个Topless</a>，他的哥哥sed坐不住了，也一定要出来抖一抖。</p>
<p>sed全名叫stream editor，流编辑器，用程序的方式来编辑文本，相当的hacker啊。sed基本上就是玩正则模式匹配，所以，玩sed的人，正则表达式一般都比较强。</p>
<p>同样，本篇文章不会说sed的全部东西，你可以参看<a href="http://www.gnu.org/software/sed/manual/sed.html" target="_blank">sed的手册</a>，我这里主要还是想和大家竞争一下那些从手机指缝间或马桶里流走的时间，用这些时间来学习一些东西。当然，接下来的还是要靠大家自己双手。</p>
<h4>用s命令替换</h4>
<p>我使用下面的这段文本做演示：</p>
<pre class="brush: bash; title: ; notranslate" title="">$ cat pets.txt<br >This is my cat<br >  my cat's name is betty<br >This is my dog<br >  my dog's name is frank<br >This is my fish<br >  my fish's name is george<br >This is my goat<br >  my goat's name is adam</pre>
<p>把其中的my字符串替换成Hao Chen’s，下面的语句应该很好理解（s表示替换命令，/my/表示匹配my，/Hao Chen’s/表示把匹配替换成Hao Chen’s，/g 表示一行上的替换所有的匹配）：</p>
<pre class="brush: bash; title: ; notranslate" title="">$ sed "s/my/Hao Chen's/g" pets.txt<br >This is Hao Chen's cat<br >  Hao Chen's cat's name is betty<br >This is Hao Chen's dog<br >  Hao Chen's dog's name is frank<br >This is Hao Chen's fish<br >  Hao Chen's fish's name is george<br >This is Hao Chen's goat<br >  Hao Chen's goat's name is adam</pre>
<p>注意：如果你要使用单引号，那么你没办法通过\’这样来转义，就有双引号就可以了，在双引号内可以用\”来转义。</p>
<p><span id="more-9104" ></p>
<p>再注意：上面的sed并没有对文件的内容改变，只是把处理过后的内容输出，如果你要写回文件，你可以使用重定向，如：</p>
<pre class="brush: bash; title: ; notranslate" title="">$ sed "s/my/Hao Chen's/g" pets.txt &gt; hao_pets.txt</pre>
<p>或使用 -i 参数直接修改文件内容：</p>
<pre class="brush: bash; title: ; notranslate" title="">$ sed -i "s/my/Hao Chen's/g" pets.txt</pre>
<p>在每一行最前面加点东西：</p>
<pre class="brush: bash; title: ; notranslate" title="">$ sed 's/^/#/g' pets.txt<br >#This is my cat<br >#  my cat's name is betty<br >#This is my dog<br >#  my dog's name is frank<br >#This is my fish<br >#  my fish's name is george<br >#This is my goat<br >#  my goat's name is adam</pre>
<p>在每一行最后面加点东西：</p>
<pre class="brush: bash; title: ; notranslate" title="">$ sed 's/$/ --- /g' pets.txt<br >This is my cat ---<br >  my cat's name is betty ---<br >This is my dog ---<br >  my dog's name is frank ---<br >This is my fish ---<br >  my fish's name is george ---<br >This is my goat ---<br >  my goat's name is adam ---</pre>
<p>顺手介绍一下正则表达式的一些最基本的东西：</p>
<ul>
<li>^ 表示一行的开头。如：/^#/ 以#开头的匹配。 
  
<li>$ 表示一行的结尾。如：/}$/ 以}结尾的匹配。 
  
<li>\&lt; 表示词首。 如&nbsp;\&lt;abc 表示以 abc 为首的詞。 
  
<li>\&gt; 表示词尾。 如 abc\&gt; 表示以 abc 結尾的詞。 
  
<li>. 表示任何单个字符。 
  
<li>* 表示某个字符出现了0次或多次。 
  
<li>[ ] 字符集合。 如：[abc]表示匹配a或b或c，还有[a-zA-Z]表示匹配所有的26个字符。如果其中有^表示反，如[^a]表示非a的字符</li>
</ul>
<p>正规则表达式是一些很牛的事，比如我们要去掉某html中的tags：</p>
<pre class="brush: xml; title: html.txt; notranslate" title="html.txt">
&lt;b&gt;This&lt;/b&gt; is what &lt;span style="text-decoration: underline;"&gt;I&lt;/span&gt; meant. Understand?

</pre>
<p>看看我们的sed命令</p>
<pre class="brush: bash; title: ; notranslate" title=""># 如果你这样搞的话，就会有问题<br >$ sed 's/&lt;.*&gt;//g' html.txt<br > Understand?<br ><br ># 要解决上面的那个问题，就得像下面这样。<br ># 其中的'[^&gt;]' 指定了除了&gt;的字符重复0次或多次。<br >$ sed 's/&lt;[^&gt;]*&gt;//g' html.txt<br >This is what I meant. Understand?</pre>
<p>我们再来看看指定需要替换的内容：</p>
<pre class="brush: bash; highlight: [4]; title: ; notranslate" title="">$ sed "3s/my/your/g" pets.txt<br >This is my cat<br >  my cat's name is betty<br >This is your dog<br >  my dog's name is frank<br >This is my fish<br >  my fish's name is george<br >This is my goat<br >  my goat's name is adam</pre>
<p>下面的命令只替换第3到第6行的文本。</p>
<pre class="brush: bash; highlight: [4,5,6,7]; title: ; notranslate" title="">$ sed "3,6s/my/your/g" pets.txt<br >This is my cat<br >  my cat's name is betty<br >This is your dog<br >  your dog's name is frank<br >This is your fish<br >  your fish's name is george<br >This is my goat<br >  my goat's name is adam</pre>
<p>&nbsp;</p>
<pre class="brush: bash; title: ; notranslate" title="">$ cat my.txt<br >This is my cat, my cat's name is betty<br >This is my dog, my dog's name is frank<br >This is my fish, my fish's name is george<br >This is my goat, my goat's name is adam</pre>
<p>只替换每一行的第一个s：</p>
<pre class="brush: bash; title: ; notranslate" title="">$ sed 's/s/S/1' my.txt<br >ThiS is my cat, my cat's name is betty<br >ThiS is my dog, my dog's name is frank<br >ThiS is my fish, my fish's name is george<br >ThiS is my goat, my goat's name is adam</pre>
<p>只替换每一行的第二个s：</p>
<pre class="brush: bash; title: ; notranslate" title="">$ sed 's/s/S/2' my.txt<br >This iS my cat, my cat's name is betty<br >This iS my dog, my dog's name is frank<br >This iS my fish, my fish's name is george<br >This iS my goat, my goat's name is adam</pre>
<p>只替换第一行的第3个以后的s：</p>
<pre class="brush: bash; title: ; notranslate" title="">$ sed 's/s/S/3g' my.txt<br >This is my cat, my cat'S name iS betty<br >This is my dog, my dog'S name iS frank<br >This is my fiSh, my fiSh'S name iS george<br >This is my goat, my goat'S name iS adam</pre>
<h4>多个匹配</h4>
<p>如果我们需要一次替换多个模式，可参看下面的示例：（第一个模式把第一行到第三行的my替换成your，第二个则把第3行以后的This替换成了That）</p>
<pre class="brush: bash; title: ; notranslate" title="">$ sed '1,3s/my/your/g; 3,$s/This/That/g' my.txt<br >This is your cat, your cat's name is betty<br >This is your dog, your dog's name is frank<br >That is your fish, your fish's name is george<br >That is my goat, my goat's name is adam</pre>
<p>上面的命令等价于：（注：下面使用的是sed的-e命令行参数）</p>
<pre class="brush: bash; title: ; notranslate" title="">sed -e '1,3s/my/your/g' -e '3,$s/This/That/g' my.txt</pre>
<p>我们可以使用&amp;来当做被匹配的变量，然后可以在基本左右加点东西。如下所示：</p>
<pre class="brush: bash; title: ; notranslate" title="">$ sed 's/my/[&amp;]/g' my.txt<br >This is [my] cat, [my] cat's name is betty<br >This is [my] dog, [my] dog's name is frank<br >This is [my] fish, [my] fish's name is george<br >This is [my] goat, [my] goat's name is adam</pre>
<h4>圆括号匹配</h4>
<p>使用圆括号匹配的示例：（圆括号括起来的正则表达式所匹配的字符串会可以当成变量来使用，sed中使用的是\1,\2…）</p>
<pre class="brush: bash; title: ; notranslate" title="">$ sed 's/This is my \([^,]*\),.*is \(.*\)/\1:\2/g' my.txt<br >cat:betty<br >dog:frank<br >fish:george<br >goat:adam</pre>
<p>上面这个例子中的正则表达式有点复杂，解开如下（去掉转义字符）：</p>
<p>正则为：This is my ([^,]*),.*is (.*)<br >
匹配为：This is my (cat),……….is (betty)</p>
<p>然后：\1就是cat，\2就是betty</p>
<h4>sed的命令</h4>
<p>让我们回到最一开始的例子pets.txt，让我们来看几个命令：</p>
<h5>N命令</h5>
<p>先来看N命令 —— 把下一行的内容纳入当成缓冲区做匹配。</p>
<p>下面的的示例会把原文本中的偶数行纳入奇数行匹配，而s只匹配并替换一次，所以，就成了下面的结果：</p>
<pre class="brush: bash; title: ; notranslate" title="">$ sed 'N;s/my/your/' pets.txt<br >This is your cat<br >  my cat's name is betty<br >This is your dog<br >  my dog's name is frank<br >This is your fish<br >  my fish's name is george<br >This is your goat<br >  my goat's name is adam</pre>
<p>也就是说，原来的文件成了：</p>
<pre class="brush: bash; title: ; notranslate" title="">This is my cat\n  my cat's name is betty<br >This is my dog\n  my dog's name is frank<br >This is my fish\n  my fish's name is george<br >This is my goat\n  my goat's name is adam</pre>
<p>这样一来，下面的例子你就明白了，</p>
<pre class="brush: bash; title: ; notranslate" title="">$ sed 'N;s/\n/,/' pets.txt<br >This is my cat,  my cat's name is betty<br >This is my dog,  my dog's name is frank<br >This is my fish,  my fish's name is george<br >This is my goat,  my goat's name is adam</pre>
<h5>a命令和i命令</h5>
<p>a命令就是append， i命令就是insert，它们是用来添加行的。如：</p>
<pre class="brush: bash; highlight: [2,12]; title: ; notranslate" title=""># 其中的1i表明，其要在第1行前插入一行（insert）<br >$ sed "1 i This is my monkey, my monkey's name is wukong" my.txt<br >This is my monkey, my monkey's name is wukong<br >This is my cat, my cat's name is betty<br >This is my dog, my dog's name is frank<br >This is my fish, my fish's name is george<br >This is my goat, my goat's name is adam<br ><br ># 其中的1a表明，其要在最后一行后追加一行（append）<br >$ sed "$ a This is my monkey, my monkey's name is wukong" my.txt<br >This is my cat, my cat's name is betty<br >This is my monkey, my monkey's name is wukong<br >This is my dog, my dog's name is frank<br >This is my fish, my fish's name is george<br >This is my goat, my goat's name is adam</pre>
<p>我们可以运用匹配来添加文本：</p>
<pre class="brush: bash; highlight: [6]; title: ; notranslate" title=""># 注意其中的/fish/a，这意思是匹配到/fish/后就追加一行<br >$ sed "/fish/a This is my monkey, my monkey's name is wukong" my.txt<br >This is my cat, my cat's name is betty<br >This is my dog, my dog's name is frank<br >This is my fish, my fish's name is george<br >This is my monkey, my monkey's name is wukong<br >This is my goat, my goat's name is adam</pre>
<p>下面这个例子是对每一行都挺插入：</p>
<pre class="brush: bash; title: ; notranslate" title="">$ sed "/my/a ----" my.txt<br >This is my cat, my cat's name is betty<br >----<br >This is my dog, my dog's name is frank<br >----<br >This is my fish, my fish's name is george<br >----<br >This is my goat, my goat's name is adam<br >----</pre>
<h5>c命令</h5>
<p>c 命令是替换匹配行</p>
<pre class="brush: bash; title: ; notranslate" title="">$ sed "2 c This is my monkey, my monkey's name is wukong" my.txt<br >This is my cat, my cat's name is betty<br >This is my monkey, my monkey's name is wukong<br >This is my fish, my fish's name is george<br >This is my goat, my goat's name is adam<br ><br >$ sed "/fish/c This is my monkey, my monkey's name is wukong" my.txt<br >This is my cat, my cat's name is betty<br >This is my dog, my dog's name is frank<br >This is my monkey, my monkey's name is wukong<br >This is my goat, my goat's name is adam</pre>
<h5>d命令</h5>
<p>删除匹配行</p>
<pre class="brush: bash; title: ; notranslate" title="">$ sed '/fish/d' my.txt<br >This is my cat, my cat's name is betty<br >This is my dog, my dog's name is frank<br >This is my goat, my goat's name is adam<br ><br >$ sed '2d' my.txt<br >This is my cat, my cat's name is betty<br >This is my fish, my fish's name is george<br >This is my goat, my goat's name is adam<br ><br >$ sed '2,$d' my.txt<br >This is my cat, my cat's name is betty</pre>
<h5>p命令</h5>
<p>打印命令</p>
<p>你可以把这个命令当成grep式的命令</p>
<pre class="brush: bash; title: ; notranslate" title=""># 匹配fish并输出，可以看到fish的那一行被打了两遍，<br ># 这是因为sed处理时会把处理的信息输出<br >$ sed '/fish/p' my.txt<br >This is my cat, my cat's name is betty<br >This is my dog, my dog's name is frank<br >This is my fish, my fish's name is george<br >This is my fish, my fish's name is george<br >This is my goat, my goat's name is adam<br ><br ># 使用n参数就好了<br >$ sed -n '/fish/p' my.txt<br >This is my fish, my fish's name is george<br ><br ># 从一个模式到另一个模式<br >$ sed -n '/dog/,/fish/p' my.txt<br >This is my dog, my dog's name is frank<br >This is my fish, my fish's name is george<br ><br >#从第一行打印到匹配fish成功的那一行<br >$ sed -n '1,/fish/p' my.txt<br >This is my cat, my cat's name is betty<br >This is my dog, my dog's name is frank<br >This is my fish, my fish's name is george</pre>
<h4>几个知识点</h4>
<p>好了，下面我们要介绍四个sed的基本知识点：</p>
<h5>Pattern Space</h5>
<p>第零个是关于-n参数的，大家也许没看懂，没关系，我们来看一下sed处理文本的伪代码，并了解一下Pattern Space的概念：</p>
<pre class="brush: cpp; title: ; notranslate" title="">foreach line in file {<br >    //放入把行Pattern_Space<br >    Pattern_Space &lt;= line;<br ><br >    // 对每个pattern space执行sed命令<br >    Pattern_Space &lt;= EXEC(sed_cmd, Pattern_Space);<br ><br >    // 如果没有指定 -n 则输出处理后的Pattern_Space<br >    if (sed option hasn't "-n")  {<br >       print Pattern_Space<br >    }<br >}</pre>
<h5>Address</h5>
<p>第一个是关于address，几乎上述所有的命令都是这样的（注：其中的!表示匹配成功后是否执行命令）</p>
<p>[address[,address]][!]{cmd}</p>
<p>address可以是一个数字，也可以是一个模式，你可以通过逗号要分隔两个address 表示两个address的区间，参执行命令cmd，伪代码如下：</p>
<pre class="brush: cpp; title: ; notranslate" title="">bool bexec = false<br >foreach line in file {<br >    if ( match(address1) ){<br >        bexec = true;<br >    }<br ><br >    if ( bexec == true) {<br >        EXEC(sed_cmd);<br >    }<br ><br >    if ( match (address2) ) {<br >        bexec = false;<br >    }<br >}</pre>
<p>关于address可以使用相对位置，如：</p>
<pre class="brush: bash; title: ; notranslate" title=""># 其中的+3表示后面连续3行<br >$ sed '/dog/,+3s/^/# /g' pets.txt<br >This is my cat<br >  my cat's name is betty<br ># This is my dog<br >#   my dog's name is frank<br ># This is my fish<br >#   my fish's name is george<br >This is my goat<br >  my goat's name is adam</pre>
<h5>命令打包</h5>
<p>第二个是cmd可以是多个，它们可以用分号分开，可以用大括号括起来作为嵌套命令。下面是几个例子：</p>
<pre class="brush: bash; highlight: [12,21,31]; title: ; notranslate" title="">$ cat pets.txt<br >This is my cat<br >  my cat's name is betty<br >This is my dog<br >  my dog's name is frank<br >This is my fish<br >  my fish's name is george<br >This is my goat<br >  my goat's name is adam<br ><br ># 对3行到第6行，执行命令/This/d<br >$ sed '3,6 {/This/d}' pets.txt<br >This is my cat<br >  my cat's name is betty<br >  my dog's name is frank<br >  my fish's name is george<br >This is my goat<br >  my goat's name is adam<br ><br ># 对3行到第6行，匹配/This/成功后，再匹配/fish/，成功后执行d命令<br >$ sed '3,6 {/This/{/fish/d}}' pets.txt<br >This is my cat<br >  my cat's name is betty<br >This is my dog<br >  my dog's name is frank<br >  my fish's name is george<br >This is my goat<br >  my goat's name is adam<br ><br ># 从第一行到最后一行，如果匹配到This，则删除之；如果前面有空格，则去除空格<br >$ sed '1,${/This/d;s/^ *//g}' pets.txt<br >my cat's name is betty<br >my dog's name is frank<br >my fish's name is george<br >my goat's name is adam </pre>
<h5>Hold Space</h5>
<p>第三个我们再来看一下 Hold Space</p>
<p>接下来，我们需要了解一下Hold Space的概念，我们先来看四个命令：</p>
<p>g： 将hold space中的内容拷贝到pattern space中，原来pattern space里的内容清除<br >
G： 将hold space中的内容append到pattern space\n后<br >
h： 将pattern space中的内容拷贝到hold space中，原来的hold space里的内容被清除<br >
H： 将pattern space中的内容append到hold space\n后<br >
x： 交换pattern space和hold space的内容</p>
<p>这些命令有什么用？我们来看两个示例吧，用到的示例文件是：</p>
<pre class="brush: bash; title: ; notranslate" title="">$ cat t.txt<br >one<br >two<br >three</pre>
<p>第一个示例：</p>
<pre class="brush: bash; highlight: [1]; title: ; notranslate" title="">$ sed 'H;g' t.txt<br >one<br ><br >one<br >two<br ><br >one<br >two<br >three</pre>
<p>是不是有点没看懂，我作个图你就看懂了。</p>
<p><IMG class="aligncenter size-full wp-image-9118" alt="" src="index_files/sed_demo_00.jpg" width=592 height=404 ></p>
<p>第二个示例，反序了一个文件的行：</p>
<pre class="brush: bash; highlight: [1]; title: ; notranslate" title="">$ sed '1!G;h;$!d' t.txt<br >three<br >two<br >one</pre>
<p>其中的 ’1!G;h;$!d’ 可拆解为三个命令</p>
<ul>
<li>1!G —— 只有第一行不执行G命令，将hold space中的内容append回到pattern 
  space 
  
<li>h —— 第一行都执行h命令，将pattern space中的内容拷贝到hold space中 
  
<li>$!d —— 除了最后一行不执行d命令，其它行都执行d命令，删除当前行</li>
</ul>
<p>这个执行序列很难理解，做个图如下大家就明白了：</p>
<p><IMG class="aligncenter size-full wp-image-9110" alt="" src="index_files/sed_demo.jpg" width=623 height=316 ></p>
<p>就先说这么多吧，希望对大家有用。</p>
<p>（全文完）
</p><br >
<div style="MARGIN-BOTTOM: 5px; CLEAR: both; MARGIN-TOP: 5px" ><div style="FLOAT: left"><!-- JiaThis Button BEGIN -->
<div class="jiathis_style">
<a class="jiathis_button_tsina" >
<a class="jiathis_button_tqq" >
<a class="jiathis_button_tsohu" >
<a class="jiathis_button_t163" >
<a class="jiathis_button_douban" >
<a class="jiathis_button_renren" >
<a class="jiathis_button_zhuaxia" >
<a class="jiathis_button_fanfou" >
<a class="jiathis_button_twitter" >
<a class="jiathis_button_fb" >
<a class="jiathis_button_gmail" >
<a class="jiathis_button_linkedin" >
<a class="jiathis_button_friendfeed" >
<a class="jiathis_button_digg" >
<a href="http://www.jiathis.com/share?uid=1541368" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank" >
<a class="jiathis_counter_style" >
</div>
<script type="text/javascript">
var jiathis_config={
	data_track_clickback:true,
	summary:"",
	hideMore:false
}
</script>
<script type="text/javascript" src="index_files/jia.js" charset="utf-8" >
<!-- JiaThis Button END --></div><div style="clear: both; margin-top: 5px; margin-bottom: 5px;" />			<div class="fixed" />
		</div><br />
<br />
<div id="post-ratings-9104-loading" class="post-ratings-loading"><img src="index_files/loading.gif" alt="Loading ..." title="Loading ..." class="post-ratings-image" height="16" width="16" />&nbsp;Loading ...</div>
 
	</div>

	<!-- related posts START --><div class="fixed" />	<!-- related posts END -->

	<script type="text/javascript" src="index_files/comment.js" />


<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-7486123-1']);
_gaq.push(['_trackPageview']);

	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();
</script>
	</div><!-- main END --><!-- sidebar START --><!-- sidebar END -->
	<div class="fixed" >
</div><!-- content END --><!-- footer START --><!-- footer END -->

</div><!-- container END -->
</div><!-- wrap END -->

<script class="javascript" src="index_files/shCore.js" >
<script class="javascript" src="index_files/shBrushCSharp.js" />
<script class="javascript" src="index_files/shBrushPhp.js" />
<script class="javascript" src="index_files/shBrushJScript.js" />
<script class="javascript" src="index_files/shBrushJava.js" />
<script class="javascript" src="index_files/shBrushVb.js" />
<script class="javascript" src="index_files/shBrushSql.js" />
<script class="javascript" src="index_files/shBrushXml.js" />
<script class="javascript" src="index_files/shBrushDelphi.js" />
<script class="javascript" src="index_files/shBrushPython.js" />
<script class="javascript" src="index_files/shBrushRuby.js" />
<script class="javascript" src="index_files/shBrushCss.js" />
<script class="javascript" src="index_files/shBrushCpp.js" />
<script class="javascript">
dp.SyntaxHighlighter.ClipboardSwf = 'http://coolshell.cn//wp-content/plugins/google-syntax-highlighter/Scripts/clipboard.swf';
dp.SyntaxHighlighter.HighlightAll('code');
</script>
<script type="text/javascript" src="index_files/shCore-1.js" >
<script type="text/javascript" src="index_files/shBrushBash.js" />
<script type="text/javascript" src="index_files/shBrushXml-1.js" />
<script type="text/javascript" src="index_files/shBrushCpp-1.js" />
<script type="text/javascript">
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://coolshell.cn//wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83c";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://coolshell.cn//wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83c";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '帮助';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = '无法找到Brush：';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush不能设置 html-script选项';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();
</script>
<script type="text/javascript">
/* <![CDATA[ */
var ratingsL10n = {"plugin_url":"http:\/\/coolshell.cn\/wp-content\/plugins\/wp-postratings","ajax_url":"http:\/\/coolshell.cn\/wp-admin\/admin-ajax.php","text_wait":"Please rate only 1 post at a time.","image":"stars_crystal","image_ext":"gif","max":"5","show_loading":"1","show_fading":"1","custom":"0"};
var ratings_mouseover_image=new Image();ratings_mouseover_image.src=ratingsL10n.plugin_url+"/images/"+ratingsL10n.image+"/rating_over."+ratingsL10n.image_ext;;
/* ]]> */
</script>
<script type="text/javascript" src="index_files/postratings-js.js" >
<script src="index_files/stat.php" language="JavaScript" charset="gb2312" />


<script src="index_files/jquery.min.js" />
<script src="index_files/jquery.bpopup-0.8.0.min.js" />

<script type="text/javascript">
;(function($) {
    $(function() {
        var url=document.referrer;
        if ( url && url.search("http://")>-1) {
            var refurl =  url.match(/:\/\/(.[^/]+)/)[1];
            if(refurl.indexOf("baidu.com")>-1){
                $('#nobaidu_dlg').bPopup();
            }
        }
    });

})(jQuery);
</script>



<div id="nobaidu_dlg" style="MIN-WIDTH: 450px; COLOR: rgb(0,0,0); PADDING-BOTTOM: 20px; PADDING-TOP: 20px; PADDING-LEFT: 20px; MIN-HEIGHT: 180px; DISPLAY: none; PADDING-RIGHT: 20px; BACKGROUND-COLOR: rgb(255,255,255)"><!--<span class="bClose" style="cursor:pointer; position:absolute; right:10px;top:5px;">x<span/>-->
    <IMG src="index_files/nobaidu.jpg" align=left >
     <p style="MARGIN-LEFT: 200px; MARGIN-TOP: 20px; LINE-HEIGHT: 30px">
     检测到你还在使用百度这个搜索引擎，<br >
     做为一个程序员，这是一种自暴自弃！<br >
     <br >
     </p>
     <p style="MARGIN-TOP: 20px" align="center">
     <b><a href="http://coolshell.cn/articles/7186.html">做环保的程序员，从不用百度开始！</a></b>
     </p>
</div><!-- Dynamic page generated in 0.529 seconds. --><!-- Cached page generated by WP-Super-Cache on 2013-03-06 17:05:21 --><!-- Compression = gzip --></SPAN></div></div></div></div></div>
<P>&nbsp;</P>
<P>&nbsp;</P></BODY></html>