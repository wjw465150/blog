<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>linux 日志logger</title>
<meta name="GENERATOR" content="WinCHM">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style>
html,body { 
	/* Default Font */
	font-family: Arial, Helvetica, sans-serif;
	font-size: 11pt;
}
</style>

</head>

<body>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><STRONG><SPAN style="FONT-SIZE: 16px">一 
通过logger命令记录日志</SPAN></STRONG></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">logger 是一个shell 
命令接口，可以通过该接口使用Syslog的系统日志模块，还可以从命令行直接向系统日志文件写入一行信息。</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">日志的级别</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="FONT-SIZE: 16px"><SPAN 
style="LINE-HEIGHT: 1.5">facility：&nbsp;<BR><BR>auth&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
－用户授权&nbsp;<BR>authpriv&nbsp;&nbsp; 
－授权和安全&nbsp;<BR>cron&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; －计划任务：at 
,cron&nbsp;<BR>daemon&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;－系统守护进程&nbsp;<BR>kern&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
－与内核有关系的信息&nbsp;<BR>lpr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
－与打印服务有关的信息。&nbsp;<BR>mail&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
－与电子邮件有关的信息&nbsp;<BR>news&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
－来自新闻服务器的信息&nbsp;<BR>syslog&nbsp;&nbsp;&nbsp;&nbsp; －由 syslog 
生成的信息&nbsp;<BR>user&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&nbsp;－用户的程序生成的信息，默认。&nbsp;<BR>uucp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; －由 uucp 
生成的信息&nbsp;<BR>local0~7&nbsp; 
&nbsp;－来定义本地策略&nbsp;<BR><BR>level:<BR><BR>level定义消息的紧急程度。按严重程度由高到低顺序排列为：emerg 
=panic（该系统不可用）&nbsp;<BR>alert&nbsp;&nbsp;&nbsp; 
－需要立即采取的动作&nbsp;<BR>crit&nbsp;&nbsp;&nbsp;&nbsp; 
－临界状态&nbsp;<BR>err&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
－错误状态。等同error&nbsp;<BR>warning&nbsp;&nbsp;－预警信息，等同warn&nbsp;<BR>notice&nbsp;&nbsp; 
－正常但是要注意&nbsp;<BR>info&nbsp;&nbsp;&nbsp;&nbsp; 
－正常消息&nbsp;<BR>debug&nbsp;&nbsp;&nbsp;&nbsp;－调试&nbsp;<BR>none&nbsp;&nbsp;&nbsp;&nbsp; 
－一般的信息&nbsp;<BR><BR></SPAN><SPAN 
style="LINE-HEIGHT: 1.5">1、解决方法：</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN 
style="FONT-SIZE: 16px">编辑syslog.conf，</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">#vi 
/etc/syslog.conf</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN 
style="FONT-SIZE: 16px">在第一行加入local3.none,使得设备local3的日志不记录在messages文件里，</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px"># Log anything (except 
mail) of level info or higher.</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px"># Don't log private 
authentication messages!</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN 
style="FONT-SIZE: 16px">*.info;mail.none;authpriv.none;cron.none;local1.none;local3.none 
/var/log/messages</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN 
style="FONT-SIZE: 16px">将设备local3的所有级别的信息都记录在userlog文件里，</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">#user 
log</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">local3.* 
/var/log/userlog</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN 
style="FONT-SIZE: 16px">重新加载syslog服务的配置文件，</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">$ service syslog 
reload</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">2、测试：</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN 
style="FONT-SIZE: 16px">测试机器的环境：</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">OS：Red Hat Enterprise 
Linux 5 update 3</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">Network: 192.168.0.100/24 
Gateway:192.168.0.1</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">$&nbsp;ping 192.168.0.1 | 
logger -it logger_test -p local3.notice &amp;</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">命令logger -it logger_test 
-p local3.notice中的参数含义：</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">-i 
在每行都记录进程ID</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">-t logger_test 
每行记录都加上“logger_test”这个标签</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">-p local3.notice 
设置记录的设备和级别</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN 
style="FONT-SIZE: 16px">ping命令的输出成功输出到/var/log/userlog文件中，实验成功。</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="FONT-SIZE: 16px"><SPAN style="LINE-HEIGHT: 1.5"></SPAN></SPAN>&nbsp;</P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="FONT-SIZE: 14px">3、<STRONG>logger命令默认的日志保存在 
/var/log/messages中</STRONG>，例如：</SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="FONT-SIZE: 14px">命令：logger -it log_test log self test</SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="FONT-SIZE: 14px">输出：tail -f /var/log/messages</SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="FONT-SIZE: 14px">Mar 17 22:41:54 localhost log_test[8673]: log self 
test</SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="FONT-SIZE: 14px"></SPAN>&nbsp;</P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><STRONG><SPAN style="FONT-SIZE: 16px">二 
日志回卷</SPAN></STRONG></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN 
style="FONT-SIZE: 16px">系统时时刻刻都在产生日志，如果不及时清理，很快就会灌满硬盘，但如果要手工清理，又很麻烦。这种情况下，logrotate 
这个程序很好的完成这个任务。</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">logrotate 
用来把旧的日志文件删除，并创建新的日志文件，我们把它叫做“转储”。我们可以根据日志文件的大小，也可以根据其天数来转储，这个过程一般通过一个叫做crond的守护进程来执行，logrotate 
还可以用于压缩日志文件，以及发送日志到指定的E-mail 。</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="FONT-SIZE: 16px"><SPAN style="LINE-HEIGHT: 1.5">logrotate 的配置文件是 
/etc/logrotate.conf。主要参数如下表：<BR>参数 
功能<BR>compress&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
通过gzip 
压缩转储以后的日志<BR>nocompress&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
不需要压缩时，用这个参数<BR>copytruncate&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;用于还在打开中的日志文件，把当前日志备份并截断<BR>nocopytruncate&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
备份日志文件但是不截断<BR>create mode owner group 
转储文件，使用指定的文件模式创建新的日志文件<BR>nocreate&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
不建立新的日志文件<BR>delaycompress&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="LINE-HEIGHT: 1.5">和 compress 
一起使用时，转储的日志文件到下一次转储时才压缩<BR>nodelaycompress&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
覆盖 delaycompress 选项，转储同时压缩。<BR>errors 
address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
专储时的错误信息发送到指定的Email 
地址<BR>ifempty&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
即使是空文件也转储，这个是 logrotate 
的缺省选项。<BR>notifempty&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
如果是空文件的话，不转储<BR>mail 
address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
把转储的日志文件发送到指定的E-mail 
地址<BR>nomail&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
转储时不发送日志文件<BR>olddir 
directory&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="LINE-HEIGHT: 1.5">转储后的日志文件放入指定的目录，必须和当前日志文件在同一个文件系统<BR>noolddir&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
转储后的日志文件和当前日志文件放在同一个目录下<BR>prerotate/endscript&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="LINE-HEIGHT: 1.5">在转储以前需要执行的命令可以放入这个对，这两个关键字必须单独成行<BR>postrotate/endscript&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="LINE-HEIGHT: 1.5">在转储以后需要执行的命令可以放入这个对，这两个关键字必须单独成行<BR>daily&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;指定转储周期为每天<BR>weekly&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
指定转储周期为每周<BR>monthly&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
指定转储周期为每月<BR>rotate 
count&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="LINE-HEIGHT: 1.5">指定日志文件删除之前转储的次数，0 指没有备份，5 指保留5 个备份<BR>tabootext [+] 
list&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="LINE-HEIGHT: 1.5">不转储指定扩展名的文件，缺省的扩展名是：.rpm-orig .rpmsave 
size&nbsp;size&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="LINE-HEIGHT: 1.5">当日志文件到达指定的大小时才转储，可以指定bytes(缺省)以及KB(sizek)或者MB 
(sizem).</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">系统对 logrotate 
的执行和操作：</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN 
style="FONT-SIZE: 16px">在/etc/cron.daily/路径下，有一个logrotate 
的shell脚本，所以cron程序会每天调用一次logrotate程序，然后logrotate程序回去检查日志文件是否符合回滚条件，并执行相应动作。</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">执行操作：/usr/sbin/logrotate 
/etc/cron.daily/logrotate.conf；</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN 
style="FONT-SIZE: 16px">在/etc/logrotate.conf文件中，有如下选项：</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px"># RPM packages drop log 
rotation information into this directory</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">include 
/etc/logrotate.d</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN 
style="FONT-SIZE: 16px">这个选项说明在执行logrotate程序时，同时执行/etc/logrotated目录下的所有脚本。</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN 
style="FONT-SIZE: 16px">执行动作示例：每月清除/var/log/wtmp目录中的相关内容：</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">/var/log/wtmp 
{</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">monthly</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">create 0664 root 
root</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">rotate 
1</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">}</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">实验：</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">1.</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">环境: Red Hat Enterprise 
Linux 5.3</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">实验描述:</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN 
style="FONT-SIZE: 16px">（1）用Cron执行logrotate命令，每分钟检查一次目标日志文件是否满足回卷限制。（2）配置/etc/logrotate.conf 
或者建立一个自定义的/etc/logrotate.d /userlog</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">（3）编辑/etc/syslog.conf 
使得记录的日志信息可以写入到/var/log/userlog中。</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">$&nbsp;crontab 
-e</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">* * * * * 
/usr/sbin/logrotate /etc/logrotate.conf //写入这条命令</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">$&nbsp;vi 
/etc/logrotate.conf</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN 
style="FONT-SIZE: 16px">***省略***</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">/var/log/userlog 
{</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">daily</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">size 10k 
////在这里单位大小写敏感应，应为 k or M</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">create 0664 root 
root</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">rotate 
3</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN 
style="FONT-SIZE: 16px">prerotate</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">/bin/kill -HUP `cat 
/var/run/syslogd.pid 2&gt; /dev/null` 2&gt; /dev/null</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">/bin/kill -HUP `cat 
/var/run/rsyslogd.pid 2&gt; /dev/null` 2&gt; /dev/null</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN 
style="FONT-SIZE: 16px">endscript</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">}</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="FONT-SIZE: 16px"><SPAN 
style="LINE-HEIGHT: 1.5">在这里一定要加prerotate这段脚本，这样可以使syslog程序重新读取配置文件，这样做的作用是让syslog程序释放对userlog文件持有的文件描述符，否则即使日志文件</SPAN><SPAN 
style="LINE-HEIGHT: 1.5">回滚，syslog也不会向新产生的日志文件写数据。举个例子，如果不加这段脚本，即使logrotate程序将userlog文件截断并重命名为userlog.1，但是syslog程序仍然会向原userlog文件即userlog.1中写入数据。</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">$&nbsp;vi 
/etc/syslog.conf</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN 
style="FONT-SIZE: 16px">*****省略*****</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN 
style="FONT-SIZE: 16px">*.info;mail.none;authpriv.none;cron.none;local1.none;local3.none 
/var/log/messages</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">#user 
log</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">local3.* 
/var/log/userlog</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN 
style="FONT-SIZE: 16px">重新加载配置文件</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">$&nbsp;service syslog 
reload</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN 
style="FONT-SIZE: 16px">重启crond服务</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN style="FONT-SIZE: 16px">$&nbsp;service crond 
restart</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN 
style="FONT-SIZE: 16px">需要注意的是，当达到限制条件时，logrotate程序会将目标日志文件userlog截断，并命名为userlog.1，将原userlog.1改名为userlog.2，以此类推，syslog程序始终向userlog文件中写数据。</SPAN></SPAN></P>
<P 
style="MARGIN-BOTTOM: 0px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(51,51,51); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 5px; FONT: 14px/1.5 宋体, Arial; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,252,243); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN 
style="LINE-HEIGHT: 1.5"><SPAN 
style="FONT-SIZE: 16px"></SPAN></SPAN>&nbsp;</P></body>
</html>
