<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>!!!jvm内存映像分析</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style>
html,body { 
	/* Default Font */
	font-family: 宋体, Arial, Helvetica, sans-serif;
	font-size: 10pt;
}
</style>

</head>

<body>&nbsp;jdk自带的jmap就是java内存映像工具，可以用于上生成堆转储快照：
<P>在eclipse中启动一个java类，打开jdk安装目录下的C:\Program 
Files\Java\jdk1.6.0_11\bin目录，双击jconsole.exe，显示连接窗口：<BR><IMG alt="" 
src="index_files/8614c388-048e-396e-b569-6ef9425f848a.jpg"><BR>&nbsp;，单击pid为6920的选项，点连接进入，可以看到jvm运行时的多种参数，</P>
<P>在运行中输入cmd，在命令行中输入以下命令</P>
<P>   C:\DocumentsandSettings\Administrator\jmap&nbsp;&nbsp;&nbsp;-dump:format=b,file=eclipse.bin 
6920&nbsp;&nbsp; ,6920为java进程的pid，回车，显示heap dump file created</P>
<P><BR><IMG alt="" 
src="index_files/66e50f87-d7be-3d36-aa5e-86d03bea3a94.jpg"><BR>&nbsp;命令行窗口键入：C:\Documents 
and Settings\Administrator\jhat eclipse.bin ,显示Server is ready后，<BR><IMG alt="" 
src="file:///D:/个人配置/My%20Documents/WinCHM%20Projects/Java资料/data/JVM/jvm内存映像分析/index_files/550abb75-73a4-3c29-aca0-e389e79ebd84.jpg"><BR>打开浏览器，输入http://localhost:7000后就可以看到分析日志了</P>
<P><BR><IMG alt="" 
src="index_files/09931436-61b8-3b8a-8f15-f81fe99a7cce.jpg"><BR>&nbsp;拉到页尾，点击Other 
Queries标题下的Show instance counts for all classes (excluding platform) 
，所有类的数目按照数目排序：</P>
<P><BR><IMG alt="" 
src="index_files/b48465e4-273d-3212-814c-5beab313f0dc.jpg"><BR>&nbsp;，点击Other 
Queries标题下的Execute Object Query Language (OQL) query 可以根据OQL语言来查询自己想要的信息：</P>
<P><BR><IMG alt="" 
src="index_files/20f505ec-1a21-31dc-82bd-692f334fd258.jpg"><BR>&nbsp;在其中输入&nbsp; 
select file.path.value.toString() from java.io.File file<BR>可以查询所有加载的文件：</P>
<P><BR><IMG alt="" 
src="index_files/4953f9a5-d1a5-3a5a-97cb-8e3c7e670641.jpg"><BR>&nbsp;，更多查询方法可以参考OQL的语法。</P></body>
