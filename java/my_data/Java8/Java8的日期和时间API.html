<!DOCTYPE html>
<html>
  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="content-type">
    <title>Java 8的日期和时间API</title>
  </head>
  <body>
    <h1 style="margin: 0px 0px 5px; font-family: &quot;Helvetica Neue&quot;, Helvetica, Tahoma, Arial, STXihei, &quot;Microsoft YaHei&quot;, 微软雅黑, sans-serif; font-weight: normal; line-height: 1.5em; color: rgb(51, 51, 51); text-rendering: optimizeLegibility; font-size: 24px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">计
      算机程序的思维逻辑 (95) - Java 8的日期和时间API</h1>
    <div class="article_meta" style="color: rgb(153, 153, 153); padding-bottom: 8px; border-bottom: 1px dashed rgb(211, 211, 211); font-size: 14px; font-family: &quot;Helvetica Neue&quot;, Helvetica, Tahoma, Arial, STXihei, &quot;Microsoft YaHei&quot;, 微软雅黑, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><br>
    </div>
    <div class="article_body" id="nei" style="padding: 20px 5px 25px; margin-bottom: 0px; overflow-x: hidden; word-wrap: break-word; word-break: break-all; min-height: 340px; font-size: 16px; line-height: 1.7em; color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, Tahoma, Arial, STXihei, &quot;Microsoft YaHei&quot;, 微软雅黑, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
      <div style="font-size: 16px; line-height: 1.7em;">
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">​本节继续探讨Java
          8的新特性，主要是介绍Java 8对日期和时间API的增强，关于日期和时间，我们在之前已经介绍过两节了，<span>&nbsp;</span><a href="http://mp.weixin.qq.com/s?__biz=MzIxOTI1NTk5Nw==&amp;mid=2650047249&amp;idx=1&amp;sn=3256f40c85e1fac4dedfa620f10e871e&amp;scene=21#wechat_redirect"
            target="_blank" rel="nofollow,noindex" style="color: rgb(148, 148, 148); text-decoration: none; transition: 0.25s; outline: none 0px; border-bottom: 1px dashed rgb(148, 148, 148); font-style: italic; font-weight: bold;">32
            节</a><span>&nbsp;</span>介绍了Java
          1.8以前的日期和时间API，主要的类是Date和Calendar，由于它的设计有一些不足，业界广泛使用的是一个第三方的类库Joda-Time，关于Joda-time，我们在<span>&nbsp;</span><a href="http://mp.weixin.qq.com/s?__biz=MzIxOTI1NTk5Nw==&amp;mid=2650047252&amp;idx=1&amp;sn=8467bf6161e3ddd3d58c89fd1e4980e8&amp;scene=21#wechat_redirect"
            target="_blank" rel="nofollow,noindex" style="color: rgb(148, 148, 148); text-decoration: none; transition: 0.25s; outline: none 0px; border-bottom: 1px dashed rgb(148, 148, 148); font-style: italic; font-weight: bold;">33
            节</a><span>&nbsp;</span>进行了介绍。Java 1.8学习了Joda-time，引入了一套新的API，位于包java.time下，本节，我们就来简要介绍这套新的API。</p>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">我们先从日期和时间的表示开始。</p>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">表示日期和时间</p>
        <h4 style="margin: 0px 0px 0.5em; font-family: inherit; font-weight: bold; line-height: 1.7em; color: inherit; text-rendering: optimizeLegibility; font-size: 16px; text-indent: 1em;">基
          本概念</h4>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">我们在<span>&nbsp;</span><a
            href="http://mp.weixin.qq.com/s?__biz=MzIxOTI1NTk5Nw==&amp;mid=2650047249&amp;idx=1&amp;sn=3256f40c85e1fac4dedfa620f10e871e&amp;scene=21#wechat_redirect"
            target="_blank" rel="nofollow,noindex" style="color: rgb(148, 148, 148); text-decoration: none; transition: 0.25s; outline: none 0px; border-bottom: 1px dashed rgb(148, 148, 148); font-style: italic; font-weight: bold;">32
            节</a><span>&nbsp;</span>介绍过日期和时间的几个基本概念，这里简要回顾下。</p>
        <ul style="padding: 0px; margin: 0px 0px 0.75em 25px; list-style-type: none; font-size: 16px; line-height: 1.7em;">
          <li style="line-height: 1.7em; list-style-type: disc; font-size: 16px;"><span>时刻：所有计算机系统内部都用一个整数表示时刻，这个整数是距离格林
              尼治标准时间1970年1月1日0时0分0秒的毫秒数，可以理解时刻就是绝对时间，它与时区无关，不同时区对同一时刻的解读，即年月日时分秒是不一样的；</span></li>
          <li style="line-height: 1.7em; list-style-type: disc; font-size: 16px;"><span>时区：同一时刻，世界上各个地区的时间可能是不一样的，具体时间与时
              区有关，一共有24个时区，英国格林尼治是0时区，北京是东八区，也就是说格林尼治凌晨1点，北京是早上9点；</span></li>
          <li style="line-height: 1.7em; list-style-type: disc; font-size: 16px;"><span>年历：我们都知道，中国有公历和农历之分，公历和农历都是年历，不同
              的年历，一年有多少月，每月有多少天，甚至一天有多少小时，这些可能都是不一样的，我们主要讨论公历。</span></li>
        </ul>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">Java
          8中表示日期和时间的类有多个，主要的有：</p>
        <ul style="padding: 0px; margin: 0px 0px 0.75em 25px; list-style-type: none; font-size: 16px; line-height: 1.7em;">
          <li style="line-height: 1.7em; list-style-type: disc; font-size: 16px;"><span>Instant：表示时刻，不直接对应年月日信息，需要通过时区转换</span></li>
          <li style="line-height: 1.7em; list-style-type: disc; font-size: 16px;"><span>LocalDateTime:
              表示与时区无关的日期和时间信息，不直接对应时刻，需要通过时区转换</span></li>
          <li style="line-height: 1.7em; list-style-type: disc; font-size: 16px;"><span>LocalDate：表示与时区无关的日期，与
              LocalDateTime相比，只有日期信息，没有时间信息</span></li>
          <li style="line-height: 1.7em; list-style-type: disc; font-size: 16px;"><span>LocalTime：表示与时区无关的时间，与
              LocalDateTime相比，只有时间信息，没有日期信息</span></li>
          <li style="line-height: 1.7em; list-style-type: disc; font-size: 16px;"><span>ZonedDateTime： 表示特定时区的日期和时间</span></li>
          <li style="line-height: 1.7em; list-style-type: disc; font-size: 16px;"><span><span>ZoneId/ZoneOffset：表示时区</span></span></li>
        </ul>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">类比较多，但概念更为清晰了，下面我们逐个来看
          下。</p>
        <h4 style="margin: 0px 0px 0.5em; font-family: inherit; font-weight: bold; line-height: 1.7em; color: inherit; text-rendering: optimizeLegibility; font-size: 16px; text-indent: 1em;">Instant</h4>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">Instant表示时刻，获取当前时刻，代码
          为：</p>
        <pre class="hljs vbscript" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 0.75em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;">Instant <span
class="hljs-built_in" style="color: rgb(57, 115, 0);">now</span> = Instant.<span class="hljs-built_in" style="color: rgb(57, 115, 0);">now</span>();
</pre>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">可以根据Epoch Time
          (纪元时)创建Instant，比如，另一种获取当前时刻的代码可以为：</p>
        <pre class="hljs nginx" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 0.75em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;"><span
class="hljs-attribute" style="color: rgb(51, 51, 51); font-weight: 700;">Instant</span> now = Instant.ofEpochMilli(System.currentTimeMillis());
</pre>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">我们知道，Date也表示时刻，Instant
          和Date可以通过纪元时相互转换，比如，转换Date为Instant，代码为：</p>
        <pre class="prettyprint hljs vbscript" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 1.5em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;"><span
class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">public</span> static Instant toInstant(<span class="hljs-built_in"
style="color: rgb(57, 115, 0);">Date</span> <span class="hljs-built_in" style="color: rgb(57, 115, 0);">date</span>) {
    return Instant.ofEpochMilli(<span class="hljs-built_in" style="color: rgb(57, 115, 0);">date</span>.getTime());
}
</pre>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">转换Instant为Date，代码为：</p>
        <pre class="prettyprint hljs typescript" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 1.5em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;"><span
class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">public</span> <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">static</span> <span
class="hljs-built_in" style="color: rgb(57, 115, 0);">Date</span> toDate(Instant instant) {
    <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">return</span> <span class="hljs-keyword"
style="color: rgb(51, 51, 51); font-weight: 700;">new</span> <span class="hljs-built_in" style="color: rgb(57, 115, 0);">Date</span>(instant.toEpochMilli());
}
</pre>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">Instant有很多基于时刻的比较和计算方
          法，大多比较直观，我们就不列举了。</p>
        <h4 style="margin: 0px 0px 0.5em; font-family: inherit; font-weight: bold; line-height: 1.7em; color: inherit; text-rendering: optimizeLegibility; font-size: 16px; text-indent: 1em;">LocalDateTime</h4>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">LocalDateTime表示与时区无关的日
          期和时间信息，获取系统默认时区的当前日期和时间，代码为：</p>
        <pre class="hljs nginx" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 0.75em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;"><span
class="hljs-attribute" style="color: rgb(51, 51, 51); font-weight: 700;">LocalDateTime</span> ldt = LocalDateTime.now();
</pre>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">还可以直接用年月日等信息构建
          LocalDateTime，比如，表示2017年7月11日20点45分5秒，代码可以为：</p>
        <pre class="hljs nginx" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 0.75em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;"><span
class="hljs-attribute" style="color: rgb(51, 51, 51); font-weight: 700;">LocalDateTime</span> ldt = LocalDateTime.of(<span
class="hljs-number" style="color: rgb(136, 0, 0);">2017</span>, <span class="hljs-number" style="color: rgb(136, 0, 0);">7</span>, <span
class="hljs-number" style="color: rgb(136, 0, 0);">11</span>, <span class="hljs-number" style="color: rgb(136, 0, 0);">20</span>, <span
class="hljs-number" style="color: rgb(136, 0, 0);">45</span>, <span class="hljs-number" style="color: rgb(136, 0, 0);">5</span>);
</pre>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">LocalDateTime有很多方法，可以获
          取年月日时分秒等日历信息，比如：</p>
        <pre class="prettyprint hljs vbscript" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 1.5em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;"><span
class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">public</span> <span class="hljs-built_in" style="color: rgb(57, 115, 0);">int</span> getYear()
<span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">public</span> <span class="hljs-built_in" style="color: rgb(57, 115, 0);">int</span> getMonthValue()
<span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">public</span> <span class="hljs-built_in" style="color: rgb(57, 115, 0);">int</span> getDayOfMonth()
<span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">public</span> <span class="hljs-built_in" style="color: rgb(57, 115, 0);">int</span> getHour()
<span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">public</span> <span class="hljs-built_in" style="color: rgb(57, 115, 0);">int</span> getMinute()
<span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">public</span> <span class="hljs-built_in" style="color: rgb(57, 115, 0);">int</span> getSecond()
</pre>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">还可以获取星期几等信息，比如：</p>
        <pre class="hljs nginx" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 0.75em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;"><span
class="hljs-attribute" style="color: rgb(51, 51, 51); font-weight: 700;">public</span> DayOfWeek getDayOfWeek() 
</pre>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">DayOfWeek是一个枚举，有七个取值，从
          DayOfWeek.MONDAY到DayOfWeek.SUNDAY。</p>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">LocalDateTime不能直接转为时刻
          Instant，转换需要一个参数ZoneOffset，ZoneOffset表示相对于格林尼治的时区差，北京是+08:00，比如，转换一个LocalDateTime为北京的时刻，方法为：</p>
        <pre class="prettyprint hljs fsharp" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 1.5em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;"><span
class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">public</span> <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">static</span> Instant toBeijingInstant(LocalDateTime ldt) {
    <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">return</span> ldt.toInstant(ZoneOffset.<span
class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">of</span>(<span class="hljs-string" style="color: rgb(136, 0, 0);">"+08:00"</span>));
}
</pre>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">给定一个时刻，使用不同时区解读，日历信息是不
          同的，Instant有方法根据时区返回一个ZonedDateTime：</p>
        <pre class="hljs lisp" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 0.75em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;">public ZonedDateTime atZone(<span
class="hljs-name" style="color: rgb(51, 51, 51); font-weight: 700;">ZoneId</span> zone)
</pre>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">默认时区是
          ZoneId.systemDefault()，可以这样构建ZoneId：</p>
        <pre class="hljs fsharp" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 0.75em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;"><span
class="hljs-comment" style="color: rgb(136, 136, 136);">//北京时区</span>
ZoneId bjZone = ZoneId.<span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">of</span>(<span class="hljs-string"
style="color: rgb(136, 0, 0);">"GMT+08:00"</span>)
</pre>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">ZoneOffset是ZoneId的子类，可
          以根据时区差构造。</p>
        <h4 style="margin: 0px 0px 0.5em; font-family: inherit; font-weight: bold; line-height: 1.7em; color: inherit; text-rendering: optimizeLegibility; font-size: 16px; text-indent: 1em;">LocalDate/LocalTime</h4>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">可以认为，LocalDateTime由两部分
          组成，一部分是日期LocalDate，另一部分是时间LocalTime，它们的用法也很直观，比如：</p>
        <pre class="prettyprint hljs fsharp" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 1.5em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;"><span
class="hljs-comment" style="color: rgb(136, 136, 136);">//表示2017年7月11日</span>
LocalDate ld = LocalDate.<span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">of</span>(<span class="hljs-number"
style="color: rgb(136, 0, 0);">2017</span>, <span class="hljs-number" style="color: rgb(136, 0, 0);">7</span>, <span class="hljs-number"
style="color: rgb(136, 0, 0);">11</span>);

<span class="hljs-comment" style="color: rgb(136, 136, 136);">//当前时刻按系统默认时区解读的日期</span>
LocalDate now = LocalDate.now();

<span class="hljs-comment" style="color: rgb(136, 136, 136);">//表示21点10分34秒</span>
LocalTime lt = LocalTime.<span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">of</span>(<span class="hljs-number"
style="color: rgb(136, 0, 0);">21</span>, <span class="hljs-number" style="color: rgb(136, 0, 0);">10</span>, <span class="hljs-number"
style="color: rgb(136, 0, 0);">34</span>);

<span class="hljs-comment" style="color: rgb(136, 136, 136);">//当前时刻按系统默认时区解读的时间</span>
LocalTime time = LocalTime.now();
</pre>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">LocalDateTime由
          LocalDate和LocalTime构成，LocalDate加上时间可以构成LocalDateTime，LocalTime加上日期可以构成LocalDateTime，比如：</p>
        <pre class="prettyprint hljs fsharp" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 1.5em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;">LocalDateTime ldt = LocalDateTime.<span
class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">of</span>(<span class="hljs-number" style="color: rgb(136, 0, 0);">2017</span>, <span
class="hljs-number" style="color: rgb(136, 0, 0);">7</span>, <span class="hljs-number" style="color: rgb(136, 0, 0);">11</span>, <span
class="hljs-number" style="color: rgb(136, 0, 0);">20</span>, <span class="hljs-number" style="color: rgb(136, 0, 0);">45</span>, <span
class="hljs-number" style="color: rgb(136, 0, 0);">5</span>);
LocalDate ld = ldt.toLocalDate(); <span class="hljs-comment" style="color: rgb(136, 136, 136);">//2017-07-11</span>
LocalTime lt = ldt.toLocalTime(); <span class="hljs-comment" style="color: rgb(136, 136, 136);">// 20:45:05</span>

<span class="hljs-comment" style="color: rgb(136, 136, 136);">//LocalDate加上时间，结果为2017-07-11 21:18:39</span>
LocalDateTime ldt2 = ld.atTime(<span class="hljs-number" style="color: rgb(136, 0, 0);">21</span>, <span class="hljs-number"
style="color: rgb(136, 0, 0);">18</span>, <span class="hljs-number" style="color: rgb(136, 0, 0);">39</span>);

<span class="hljs-comment" style="color: rgb(136, 136, 136);">//LocalTime加上日期，结果为2016-03-24 20:45:05</span>
LocalDateTime ldt3 = lt.atDate(LocalDate.<span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">of</span>(<span
class="hljs-number" style="color: rgb(136, 0, 0);">2016</span>, <span class="hljs-number" style="color: rgb(136, 0, 0);">3</span>, <span
class="hljs-number" style="color: rgb(136, 0, 0);">24</span>));
</pre>
        <h4 style="margin: 0px 0px 0.5em; font-family: inherit; font-weight: bold; line-height: 1.7em; color: inherit; text-rendering: optimizeLegibility; font-size: 16px; text-indent: 1em;">ZonedDateTime</h4>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">ZonedDateTime表示特定时区的日期
          和时间，获取系统默认时区的当前日期和时间，代码为：</p>
        <pre class="hljs nginx" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 0.75em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;"><span
class="hljs-attribute" style="color: rgb(51, 51, 51); font-weight: 700;">ZonedDateTime</span> zdt = ZonedDateTime.now();
</pre>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">LocalDateTime.now()也是获
          取默认时区的当前日期和时间，有什么区别呢？<span>&nbsp;</span><span>LocalDateTime内部不会记录时区信息，只会单纯记录年月日时分秒等信息，而ZonedDateTime除了记录日历信息，还
            会记录时区<span>&nbsp;</span><span>，它的其他大部分构建方法都需要显式传递时区，比如：</span></span></p>
        <pre class="prettyprint hljs fsharp" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 1.5em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;"><span
class="hljs-comment" style="color: rgb(136, 136, 136);">//根据Instant和时区构建ZonedDateTime</span>
<span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">public</span> <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">static</span> ZonedDateTime ofInstant(Instant instant, ZoneId zone)

<span class="hljs-comment" style="color: rgb(136, 136, 136);">//根据LocalDate, LocalTime和ZoneId构造</span>
<span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">public</span> <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">static</span> ZonedDateTime <span
class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">of</span>(LocalDate date, LocalTime time, ZoneId zone) 
</pre>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">ZonedDateTime可以直接转换为
          Instant，比如：</p>
        <pre class="prettyprint hljs nginx" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 1.5em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;"><span
class="hljs-attribute" style="color: rgb(51, 51, 51); font-weight: 700;">ZonedDateTime</span> ldt = ZonedDateTime.now();
<span class="hljs-attribute" style="color: rgb(51, 51, 51); font-weight: 700;">Instant</span> now = ldt.toInstant();
</pre>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">格式化/解析字符串</p>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">Java
          8中，主要的格式化类是java.time.format.DateTimeFormatter，它是线程安全的，看个例子：</p>
        <pre class="prettyprint hljs erlang" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 1.5em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;">DateTimeFormatter formatter = DateTimeFormatter.<span
class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">of</span>Pattern(<span class="hljs-string" style="color: rgb(136, 0, 0);">"yyyy-MM-dd HH:mm:ss"</span>);
LocalDateTime ldt = LocalDateTime.<span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">of</span>(<span
class="hljs-number" style="color: rgb(136, 0, 0);">2016</span>,<span class="hljs-number" style="color: rgb(136, 0, 0);">8</span>,<span
class="hljs-number" style="color: rgb(136, 0, 0);">18</span>,<span class="hljs-number" style="color: rgb(136, 0, 0);">14</span>,<span
class="hljs-number" style="color: rgb(136, 0, 0);">20</span>,<span class="hljs-number" style="color: rgb(136, 0, 0);">45</span>);
System.out.println(formatter.format(ldt));
</pre>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">输出为：</p>
        <pre class="hljs less" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 0.75em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;"><span
class="hljs-selector-tag" style="color: rgb(51, 51, 51); font-weight: 700;">2016-08-18</span> <span class="hljs-selector-tag"
style="color: rgb(51, 51, 51); font-weight: 700;">14</span><span class="hljs-selector-pseudo" style="color: rgb(188, 96, 96);">:20</span><span
class="hljs-selector-pseudo" style="color: rgb(188, 96, 96);">:45</span>
</pre>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">将字符串转化为日期和时间对象，可以使用对应类
          的parse方法，比如：</p>
        <pre class="prettyprint hljs nginx" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 1.5em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;"><span
class="hljs-attribute" style="color: rgb(51, 51, 51); font-weight: 700;">DateTimeFormatter</span> formatter = DateTimeFormatter.ofPattern(<span
class="hljs-string" style="color: rgb(136, 0, 0);">"yyyy-MM-dd HH:mm:ss"</span>);
<span class="hljs-attribute" style="color: rgb(51, 51, 51); font-weight: 700;">String</span> str = <span class="hljs-string"
style="color: rgb(136, 0, 0);">"2016-08-18 14:20:45"</span>;
<span class="hljs-attribute" style="color: rgb(51, 51, 51); font-weight: 700;">LocalDateTime</span> ldt = LocalDateTime.parse(str, formatter);
</pre>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">设置和修改时间</p>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">修改时期和时间有两种方式，一种是直接设置绝对
          值，另一种是在现有值的基础上进行相对增减操作，Java 8的大部分类都支持这两种方式，另外，与Joda-Time一样，<span>&nbsp;</span><span>Java
            8的大部分类都是不可变类，修改操作是通过创建并返回新对象来实现的，原对象本身不会变。</span></p>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">我们来看一些例子。</p>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">调整时间为下午3点20</p>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">代码示例为：</p>
        <pre class="prettyprint hljs nginx" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 1.5em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;"><span
class="hljs-attribute" style="color: rgb(51, 51, 51); font-weight: 700;">LocalDateTime</span> ldt = LocalDateTime.now();
<span class="hljs-attribute" style="color: rgb(51, 51, 51); font-weight: 700;">ldt</span> = ldt.withHour(<span class="hljs-number"
style="color: rgb(136, 0, 0);">15</span>).withMinute(<span class="hljs-number" style="color: rgb(136, 0, 0);">20</span>).withSecond(<span
class="hljs-number" style="color: rgb(136, 0, 0);">0</span>).withNano(<span class="hljs-number" style="color: rgb(136, 0, 0);">0</span>);
</pre>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">还可以为：</p>
        <pre class="prettyprint hljs nginx" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 1.5em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;"><span
class="hljs-attribute" style="color: rgb(51, 51, 51); font-weight: 700;">LocalDateTime</span> ldt = LocalDateTime.now();
<span class="hljs-attribute" style="color: rgb(51, 51, 51); font-weight: 700;">ldt</span> = ldt.toLocalDate().atTime(<span
class="hljs-number" style="color: rgb(136, 0, 0);">15</span>, <span class="hljs-number" style="color: rgb(136, 0, 0);">20</span>);
</pre>
        <h4 style="margin: 0px 0px 0.5em; font-family: inherit; font-weight: bold; line-height: 1.7em; color: inherit; text-rendering: optimizeLegibility; font-size: 16px; text-indent: 1em;">三
          小时五分钟后</h4>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">示例代码为：</p>
        <pre class="prettyprint hljs nginx" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 1.5em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;"><span
class="hljs-attribute" style="color: rgb(51, 51, 51); font-weight: 700;">LocalDateTime</span> ldt = LocalDateTime.now();
<span class="hljs-attribute" style="color: rgb(51, 51, 51); font-weight: 700;">ldt</span> = ldt.plusHours(<span class="hljs-number"
style="color: rgb(136, 0, 0);">3</span>).plusMinutes(<span class="hljs-number" style="color: rgb(136, 0, 0);">5</span>);
</pre>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">LocalDateTime有很多
          plusXXX和minusXXX方法，用于相对增加和减少时间。</p>
        <h4 style="margin: 0px 0px 0.5em; font-family: inherit; font-weight: bold; line-height: 1.7em; color: inherit; text-rendering: optimizeLegibility; font-size: 16px; text-indent: 1em;">今
          天0点</h4>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">可以为：</p>
        <pre class="prettyprint hljs nginx" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 1.5em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;"><span
class="hljs-attribute" style="color: rgb(51, 51, 51); font-weight: 700;">LocalDateTime</span> ldt = LocalDateTime.now();
<span class="hljs-attribute" style="color: rgb(51, 51, 51); font-weight: 700;">ldt</span> = ldt.with(ChronoField.MILLI_OF_DAY, <span
class="hljs-number" style="color: rgb(136, 0, 0);">0</span>);      
</pre>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">ChronoField是一个枚举，里面定义了
          很多表示日历的字段，MILLI_OF_DAY表示在一天中的毫秒数，值从0到(24 * 60 * 60 * 1,000) - 1。</p>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">还可以为：</p>
        <pre class="hljs nginx" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 0.75em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;"><span
class="hljs-attribute" style="color: rgb(51, 51, 51); font-weight: 700;">LocalDateTime</span> ldt = LocalDateTime.of(LocalDate.now(), LocalTime.MIN);
</pre>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">LocalTime.MIN表示"00:00"</p>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">也可以为：</p>
        <pre class="hljs nginx" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 0.75em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;"><span
class="hljs-attribute" style="color: rgb(51, 51, 51); font-weight: 700;">LocalDateTime</span> ldt = LocalDate.now().atTime(<span
class="hljs-number" style="color: rgb(136, 0, 0);">0</span>, <span class="hljs-number" style="color: rgb(136, 0, 0);">0</span>);
</pre>
        <h4 style="margin: 0px 0px 0.5em; font-family: inherit; font-weight: bold; line-height: 1.7em; color: inherit; text-rendering: optimizeLegibility; font-size: 16px; text-indent: 1em;">下
          周二上午10点整</h4>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">可以为：</p>
        <pre class="prettyprint hljs vbscript" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 1.5em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;">LocalDateTime ldt = LocalDateTime.<span
class="hljs-built_in" style="color: rgb(57, 115, 0);">now</span>();
ldt = ldt.plusWeeks(<span class="hljs-number" style="color: rgb(136, 0, 0);">1</span>).<span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">with</span>(ChronoField.DAY_OF_WEEK, <span
class="hljs-number" style="color: rgb(136, 0, 0);">2</span>)
    .<span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">with</span>(ChronoField.MILLI_OF_DAY, <span
class="hljs-number" style="color: rgb(136, 0, 0);">0</span>).withHour(<span class="hljs-number" style="color: rgb(136, 0, 0);">10</span>);
</pre>
        <h4 style="margin: 0px 0px 0.5em; font-family: inherit; font-weight: bold; line-height: 1.7em; color: inherit; text-rendering: optimizeLegibility; font-size: 16px; text-indent: 1em;">下
          一个周二上午10点整</h4>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">上面下周二指定是下周，如果是下一个周二呢？这
          与当前是周几有关，如果当前是周一，则下一个周二就是明天，而其他情况则是下周，代码可以为：</p>
        <pre class="prettyprint hljs vbscript" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 1.5em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;">LocalDate ld = LocalDate.<span
class="hljs-built_in" style="color: rgb(57, 115, 0);">now</span>();
<span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">if</span>(!ld.getDayOfWeek().equals(DayOfWeek.MONDAY)){
    ld = ld.plusWeeks(<span class="hljs-number" style="color: rgb(136, 0, 0);">1</span>);
}
LocalDateTime ldt = ld.<span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">with</span>(ChronoField.DAY_OF_WEEK, <span
class="hljs-number" style="color: rgb(136, 0, 0);">2</span>).atTime(<span class="hljs-number" style="color: rgb(136, 0, 0);">10</span>, <span
class="hljs-number" style="color: rgb(136, 0, 0);">0</span>);
</pre>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">针对这种复杂一点的调整，Java
          8有一个专门的接口TemporalAdjuster，这是一个函数式接口，定义为：</p>
        <pre class="prettyprint hljs java" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 1.5em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;"><span
class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">public</span> <span class="hljs-class"><span class="hljs-keyword"
style="color: rgb(51, 51, 51); font-weight: 700;">interface</span> <span class="hljs-title" style="color: rgb(136, 0, 0); font-weight: bold;">TemporalAdjuster</span> </span>{
    <span class="hljs-function">Temporal <span class="hljs-title" style="color: rgb(136, 0, 0); font-weight: bold;">adjustInto</span><span
class="hljs-params">(Temporal temporal)</span></span>;
}
</pre>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">Temporal是一个接口，表示日期或时间对
          象，Instant，LocalDateTime，LocalDate等都实现了它，这个接口就是对日期或时间进行调整，还有一个专门的类TemporalAdjusters，里面提供了很多TemporalAdjuster的实现，
          比如，针对下一个周几的调整，方法是：</p>
        <pre class="hljs gradle" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 0.75em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;"><span
class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">public</span> <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">static</span> TemporalAdjuster <span
class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">next</span>(DayOfWeek dayOfWeek)
</pre>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">针对上面的例子，代码可以为：</p>
        <pre class="prettyprint hljs vbscript" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 1.5em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;">LocalDate ld = LocalDate.<span
class="hljs-built_in" style="color: rgb(57, 115, 0);">now</span>();
LocalDateTime ldt = ld.<span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">with</span>(TemporalAdjusters.<span
class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">next</span>(DayOfWeek.TUESDAY)).atTime(<span class="hljs-number"
style="color: rgb(136, 0, 0);">10</span>, <span class="hljs-number" style="color: rgb(136, 0, 0);">0</span>);
</pre>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">这个next方法是怎么实现的呢？看代码：</p>
        <pre class="prettyprint hljs gradle" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 1.5em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;"><span
class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">public</span> <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">static</span> TemporalAdjuster <span
class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">next</span>(DayOfWeek dayOfWeek) {
    <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">int</span> dowValue = dayOfWeek.getValue();
    <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">return</span> (temporal) -&gt; {
        <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">int</span> calDow = temporal.get(DAY_OF_WEEK);
        <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">int</span> daysDiff = calDow - dowValue;
        <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">return</span> temporal.<span class="hljs-keyword"
style="color: rgb(51, 51, 51); font-weight: 700;">plus</span>(daysDiff &gt;= <span class="hljs-number" style="color: rgb(136, 0, 0);">0</span> ? <span
class="hljs-number" style="color: rgb(136, 0, 0);">7</span> - daysDiff : -daysDiff, DAYS);
    };
}
</pre>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">它内部封装了一些条件判断和具体调整，提供了更
          为易用的接口。</p>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">TemporalAdjusters中还有很多
          方法，部分方法如下：</p>
        <pre class="prettyprint hljs gradle" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 1.5em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;"><span
class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">public</span> <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">static</span> TemporalAdjuster firstDayOfMonth()
<span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">public</span> <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">static</span> TemporalAdjuster lastDayOfMonth()
<span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">public</span> <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">static</span> TemporalAdjuster firstInMonth(DayOfWeek dayOfWeek)
<span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">public</span> <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">static</span> TemporalAdjuster lastInMonth(DayOfWeek dayOfWeek)
<span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">public</span> <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">static</span> TemporalAdjuster <span
class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">previous</span>(DayOfWeek dayOfWeek)
<span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">public</span> <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">static</span> TemporalAdjuster nextOrSame(DayOfWeek dayOfWeek)
</pre>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">这些方法的含义比较直观，就不解释了，它们主要
          是封装了日期和时间调整的一些基本操作，更为易用。</p>
        <h4 style="margin: 0px 0px 0.5em; font-family: inherit; font-weight: bold; line-height: 1.7em; color: inherit; text-rendering: optimizeLegibility; font-size: 16px; text-indent: 1em;">明
          天最后一刻</h4>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">代码可以为：</p>
        <pre class="prettyprint hljs nginx" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 1.5em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;"><span
class="hljs-attribute" style="color: rgb(51, 51, 51); font-weight: 700;">LocalDateTime</span> ldt = LocalDateTime.of(LocalDate.now().plusDays(<span
class="hljs-number" style="color: rgb(136, 0, 0);">1</span>), LocalTime.MAX);
</pre>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">或者为：</p>
        <pre class="hljs nginx" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 0.75em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;"><span
class="hljs-attribute" style="color: rgb(51, 51, 51); font-weight: 700;">LocalDateTime</span> ldt = LocalTime.MAX.atDate(LocalDate.now().plusDays(<span
class="hljs-number" style="color: rgb(136, 0, 0);">1</span>));
</pre>
        <h4 style="margin: 0px 0px 0.5em; font-family: inherit; font-weight: bold; line-height: 1.7em; color: inherit; text-rendering: optimizeLegibility; font-size: 16px; text-indent: 1em;">本
          月最后一天最后一刻</h4>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">代码可以为：</p>
        <pre class="prettyprint hljs nginx" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 1.5em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;"><span
class="hljs-attribute" style="color: rgb(51, 51, 51); font-weight: 700;">LocalDateTime</span> ldt =  LocalDate.now()
        .with(TemporalAdjusters.<span class="hljs-literal" style="color: rgb(120, 169, 96);">last</span>DayOfMonth())
        .atTime(LocalTime.MAX);
</pre>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">lastDayOfMonth()是怎么实现的
          呢？看代码：</p>
        <pre class="prettyprint hljs livescript" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 1.5em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;">public static TemporalAdjuster lastDayOfMonth() {
    <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">return</span> <span class="hljs-function"><span
class="hljs-params">(temporal)</span> -&gt;</span> temporal.<span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">with</span>(DAY_OF_MONTH, temporal.range(DAY_OF_MONTH).getMaximum());
}        
</pre>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">这里使用了range方法，从它的返回值可以获
          取对应日历单位的最大最小值，展开来，本月最后一天最后一刻的代码还可以为：</p>
        <pre class="prettyprint hljs vbscript" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 1.5em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;">long maxDayOfMonth = LocalDate.<span
class="hljs-built_in" style="color: rgb(57, 115, 0);">now</span>().range(ChronoField.DAY_OF_MONTH).getMaximum();
LocalDateTime ldt =  LocalDate.<span class="hljs-built_in" style="color: rgb(57, 115, 0);">now</span>()
        .withDayOfMonth((<span class="hljs-built_in" style="color: rgb(57, 115, 0);">int</span>)maxDayOfMonth)
        .atTime(LocalTime.MAX);
</pre>
        <h4 style="margin: 0px 0px 0.5em; font-family: inherit; font-weight: bold; line-height: 1.7em; color: inherit; text-rendering: optimizeLegibility; font-size: 16px; text-indent: 1em;">下
          个月第一个周一的下午5点整</h4>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">代码可以为：</p>
        <pre class="prettyprint hljs vbscript" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 1.5em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;">LocalDateTime ldt = LocalDate.<span
class="hljs-built_in" style="color: rgb(57, 115, 0);">now</span>()
        .plusMonths(<span class="hljs-number" style="color: rgb(136, 0, 0);">1</span>)
        .<span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">with</span>(TemporalAdjusters.firstInMonth(DayOfWeek.MONDAY))
        .atTime(<span class="hljs-number" style="color: rgb(136, 0, 0);">17</span>, <span class="hljs-number" style="color: rgb(136, 0, 0);">0</span>);&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; 
</pre>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">时间段的计算</p>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">Java
          8中表示时间段的类主要有两个，Period和Duration，Period表示日期之间的差，用年月日表示，不能表示时间，Duration表示时间差，用时分秒表等表示，也可以用天表示，一天严格等于24小时，不能用年月表示，下面看一些例子。</p>
        <h4 style="margin: 0px 0px 0.5em; font-family: inherit; font-weight: bold; line-height: 1.7em; color: inherit; text-rendering: optimizeLegibility; font-size: 16px; text-indent: 1em;">计
          算两个日期之间的差</h4>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">看个Period的例子：</p>
        <pre class="prettyprint hljs xquery" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 1.5em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;">LocalDate ld1 = LocalDate.<span
class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">of</span>(<span class="hljs-number" style="color: rgb(136, 0, 0);">2016</span>, <span
class="hljs-number" style="color: rgb(136, 0, 0);">3</span>, <span class="hljs-number" style="color: rgb(136, 0, 0);">24</span>);
LocalDate ld2 = LocalDate.<span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">of</span>(<span class="hljs-number"
style="color: rgb(136, 0, 0);">2017</span>, <span class="hljs-number" style="color: rgb(136, 0, 0);">7</span>, <span class="hljs-number"
style="color: rgb(136, 0, 0);">12</span>);
Period period = Period.between(ld1, ld2);
System.out.println(period.getYears() + <span class="hljs-string" style="color: rgb(136, 0, 0);">"年"</span>
        + period.getMonths() + <span class="hljs-string" style="color: rgb(136, 0, 0);">"月"</span> + period.getDays() + <span
class="hljs-string" style="color: rgb(136, 0, 0);">"天"</span>);
</pre>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">输出为：</p>
        <pre class="hljs" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 0.75em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;">1年3月18天
</pre>
        <h4 style="margin: 0px 0px 0.5em; font-family: inherit; font-weight: bold; line-height: 1.7em; color: inherit; text-rendering: optimizeLegibility; font-size: 16px; text-indent: 1em;">根
          据生日计算年龄</h4>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">示例代码可以为：</p>
        <pre class="prettyprint hljs vbscript" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 1.5em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;">LocalDate born = LocalDate.of(<span
class="hljs-number" style="color: rgb(136, 0, 0);">1990</span>,<span class="hljs-number" style="color: rgb(136, 0, 0);">06</span>,<span
class="hljs-number" style="color: rgb(136, 0, 0);">20</span>);
<span class="hljs-built_in" style="color: rgb(57, 115, 0);">int</span> <span class="hljs-built_in" style="color: rgb(57, 115, 0);">year</span> = Period.between(born, LocalDate.<span
class="hljs-built_in" style="color: rgb(57, 115, 0);">now</span>()).getYears();
</pre>
        <h4 style="margin: 0px 0px 0.5em; font-family: inherit; font-weight: bold; line-height: 1.7em; color: inherit; text-rendering: optimizeLegibility; font-size: 16px; text-indent: 1em;">计
          算迟到分钟数</h4>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">假定早上9点是上班时间，过了9点算迟到，迟到
          要统计迟到的分钟数，怎么计算呢？看代码：</p>
        <pre class="prettyprint hljs vbnet" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 1.5em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;"><span
class="hljs-built_in" style="color: rgb(57, 115, 0);">long</span> lateMinutes = Duration.between(
        LocalTime.<span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">of</span>(<span class="hljs-number"
style="color: rgb(136, 0, 0);">9</span>,<span class="hljs-number" style="color: rgb(136, 0, 0);">0</span>),
        LocalTime.now()).toMinutes(); 
</pre>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">与Date/Calendar对象的转换</p>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">Java
          8的日期和时间API没有提供与老的Date/Calendar相互转换的方法，但在实际中，我们可能是需要的，前面介绍了，Date可以与Instant通过毫秒数相互转换，对于其他类型，也可以通过毫秒数/Instant相互转换。</p>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">比如，将LocalDateTime按默认时区
          转换为Date，代码可以为：</p>
        <pre class="prettyprint hljs typescript" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 1.5em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;"><span
class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">public</span> <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">static</span> <span
class="hljs-built_in" style="color: rgb(57, 115, 0);">Date</span> toDate(LocalDateTime ldt){
    <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">return</span> <span class="hljs-keyword"
style="color: rgb(51, 51, 51); font-weight: 700;">new</span> <span class="hljs-built_in" style="color: rgb(57, 115, 0);">Date</span>(ldt.atZone(ZoneId.systemDefault())
            .toInstant().toEpochMilli());
}
</pre>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">将ZonedDateTime转换为
          Calendar，代码可以为：</p>
        <pre class="prettyprint hljs cpp" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 1.5em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;"><span
class="hljs-function"><span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">public</span> <span class="hljs-keyword"
style="color: rgb(51, 51, 51); font-weight: 700;">static</span> Calendar <span class="hljs-title" style="color: rgb(136, 0, 0); font-weight: bold;">toCalendar</span><span
class="hljs-params">(ZonedDateTime zdt)</span> </span>{
    TimeZone tz = TimeZone.getTimeZone(zdt.getZone());
    Calendar calendar = Calendar.getInstance(tz);
    calendar.setTimeInMillis(zdt.toInstant().toEpochMilli());
    <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">return</span> calendar;
}
</pre>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">Calendar保持了
          ZonedDateTime的时区信息。</p>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">将Date按默认时区转为
          LocalDateTime，代码可以为：</p>
        <pre class="prettyprint hljs vbscript" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 1.5em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;"><span
class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">public</span> static LocalDateTime toLocalDateTime(<span
class="hljs-built_in" style="color: rgb(57, 115, 0);">Date</span> <span class="hljs-built_in" style="color: rgb(57, 115, 0);">date</span>) {
    return LocalDateTime.ofInstant(
            Instant.ofEpochMilli(<span class="hljs-built_in" style="color: rgb(57, 115, 0);">date</span>.getTime()),
            ZoneId.systemDefault());
}
</pre>
        <p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 1.7em; text-indent: 1em;">将Calendar转为
          ZonedDateTime，代码可以为：</p>
        <pre class="prettyprint hljs cpp" style="padding: 0.5em; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(68, 68, 68); border-radius: 4px; display: block; margin: 0px 0px 1.5em; font-size: 14px; line-height: 1.5em; word-break: break-all; word-wrap: break-word; white-space: pre; background-color: rgb(246, 246, 246); border: none; overflow-x: auto;"><span
class="hljs-function"><span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">public</span> <span class="hljs-keyword"
style="color: rgb(51, 51, 51); font-weight: 700;">static</span> ZonedDateTime <span class="hljs-title" style="color: rgb(136, 0, 0); font-weight: bold;">toZonedDateTime</span><span
class="hljs-params">(Calendar calendar)</span> </span>{
    ZonedDateTime zdt = ZonedDateTime.ofInstant(
            Instant.ofEpochMilli(calendar.getTimeInMillis()),
            calendar.getTimeZone().toZoneId());
    <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">return</span> zdt;
}
</pre>
        <h4 style="margin: 0px 0px 0.5em; font-family: inherit; font-weight: bold; line-height: 1.7em; color: inherit; text-rendering: optimizeLegibility; font-size: 16px; text-indent: 1em;"><br>
        </h4>
      </div>
    </div>
  </body>
</html>
