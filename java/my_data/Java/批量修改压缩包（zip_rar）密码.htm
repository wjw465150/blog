<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>批量修改压缩包（zip/rar）密码</title>
<meta name="GENERATOR" content="WinCHM">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style>
html,body { 
	/* Default Font */
	font-family: Arial, Helvetica, sans-serif;
	font-size: 11pt;
}
</style>

</head>

<body>
<P 
style="WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">今天项目遇到一个恶心的需求，将一个目录下的所有压缩文件（1500个）密码从1234改成12345678。</P>
<P 
style="WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">java实现这个小程序会遇到 
文件名包含特殊字符和转码等问题。果断bat解决</P>
<P 
style="WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">bat脚本如下：</P>
<DIV class=dp-highlighter 
style="OVERFLOW: auto; WORD-WRAP: break-word; WIDTH: 679px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; WORD-BREAK: break-all; COLOR: rgb(0,0,0); PADDING-BOTTOM: 1px; TEXT-ALIGN: left; PADDING-TOP: 1px; FONT: 12px/25px Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; PADDING-LEFT: 1px; MARGIN-LEFT: 9px; LETTER-SPACING: normal; PADDING-RIGHT: 1px; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">
<DIV class=bar>
<DIV class=tools 
style="FONT-WEIGHT: bold; COLOR: black; PADDING-BOTTOM: 3px; TEXT-ALIGN: left; PADDING-TOP: 3px; PADDING-LEFT: 3px; MARGIN: 0px; PADDING-RIGHT: 3px">Java代码<SPAN 
class=Apple-converted-space>&nbsp;</SPAN><EMBED 
type=application/x-shockwave-flash 
pluginspage=http://www.macromedia.com/go/getflashplayer height=15 width=14 
src="http://snkcxy.iteye.com/javascripts/syntaxhighlighter/clipboard_new.swf" 
wmode="transparent" flashvars="clipboard=set%20%22rar%3DC%3A%5CProgram%20Files%5CWinRAR%5CWinRAR.exe%22%0Afor%20%2Fr%20%25%25i%20in%20(*.zip)%20do%20(%0A%22%25rar%25%22%20x%20-ad%20-y%20-p1234%20%20%22%25%25i%22%20%22%25%25~pi%22%20%0A%22%25rar%25%22%20a%20-df%20-ep1%20-r%20-y%20-ibck%20-o%20-p12345678%20%20%22%25%25~pi%25%25~ni.zip%22%20%22%25%25~pi%25%25~ni%5C%22%20)%0Apause" 
quality="high" 
allowscriptaccess="always">&nbsp;<A 
onclick="code_favorites_do_favorite(this);return false;" title=收藏这段代码 
style="TEXT-DECORATION: underline; COLOR: rgb(16,138,198)" 
href="javascript:void()"><IMG class=star 
style="BORDER-TOP: 0px; BORDER-RIGHT: 0px; BORDER-BOTTOM: 0px; BORDER-LEFT: 0px" 
alt=收藏代码 src="http://snkcxy.iteye.com/images/icon_star.png"></A></DIV></DIV>
<OL class=dp-j 
style="LIST-STYLE-TYPE: decimal; FONT-SIZE: 1em; BORDER-TOP: rgb(209,215,220) 1px solid; BORDER-RIGHT: rgb(209,215,220) 1px solid; BORDER-BOTTOM: rgb(209,215,220) 1px solid; COLOR: rgb(43,145,175); PADDING-BOTTOM: 2px; PADDING-TOP: 2px; PADDING-LEFT: 0px; MARGIN: 0px 0px 1px; BORDER-LEFT: rgb(209,215,220) 1px solid; LINE-HEIGHT: 1.4em; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255)">
  <LI 
  style="FONT-SIZE: 1em; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 10px; MARGIN: 0px 0px 0px 38px; BORDER-LEFT: rgb(209,215,220) 1px solid; LINE-HEIGHT: 18px; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(250,250,250)"><SPAN 
  style="COLOR: black"><SPAN style="COLOR: black">set&nbsp;</SPAN><SPAN 
  class=string 
  style="COLOR: blue">"rar=C:\Program&nbsp;Files\WinRAR\WinRAR.exe"</SPAN><SPAN 
  style="COLOR: black">&nbsp;&nbsp;</SPAN></SPAN>
  <LI 
  style="FONT-SIZE: 1em; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 10px; MARGIN: 0px 0px 0px 38px; BORDER-LEFT: rgb(209,215,220) 1px solid; LINE-HEIGHT: 18px; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(250,250,250)"><SPAN 
  style="COLOR: black"><SPAN class=keyword 
  style="FONT-WEIGHT: bold; COLOR: rgb(127,0,85)">for</SPAN><SPAN 
  style="COLOR: black">&nbsp;/r&nbsp;%%i&nbsp;in&nbsp;(*.zip)&nbsp;</SPAN><SPAN 
  class=keyword style="FONT-WEIGHT: bold; COLOR: rgb(127,0,85)">do</SPAN><SPAN 
  style="COLOR: black">&nbsp;(&nbsp;&nbsp;</SPAN></SPAN>
  <LI 
  style="FONT-SIZE: 1em; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 10px; MARGIN: 0px 0px 0px 38px; BORDER-LEFT: rgb(209,215,220) 1px solid; LINE-HEIGHT: 18px; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(250,250,250)"><SPAN 
  style="COLOR: black"><SPAN class=string 
  style="COLOR: blue">"%rar%"</SPAN><SPAN 
  style="COLOR: black">&nbsp;x&nbsp;-ad&nbsp;-y&nbsp;-p1234&nbsp;&nbsp;</SPAN><SPAN 
  class=string style="COLOR: blue">"%%i"</SPAN><SPAN 
  style="COLOR: black">&nbsp;</SPAN><SPAN class=string 
  style="COLOR: blue">"%%~pi"</SPAN><SPAN 
  style="COLOR: black">&nbsp;&nbsp;&nbsp;</SPAN></SPAN>
  <LI 
  style="FONT-SIZE: 1em; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 10px; MARGIN: 0px 0px 0px 38px; BORDER-LEFT: rgb(209,215,220) 1px solid; LINE-HEIGHT: 18px; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(250,250,250)"><SPAN 
  style="COLOR: black"><SPAN class=string 
  style="COLOR: blue">"%rar%"</SPAN><SPAN 
  style="COLOR: black">&nbsp;a&nbsp;-df&nbsp;-ep1&nbsp;-r&nbsp;-y&nbsp;-ibck&nbsp;-o&nbsp;-p12345678&nbsp;&nbsp;</SPAN><SPAN 
  class=string style="COLOR: blue">"%%~pi%%~ni.zip"</SPAN><SPAN 
  style="COLOR: black">&nbsp;</SPAN><SPAN class=string 
  style="COLOR: blue">"%%~pi%%~ni\"</SPAN><SPAN 
  style="COLOR: black">&nbsp;)&nbsp;&nbsp;</SPAN></SPAN>
  <LI 
  style="FONT-SIZE: 1em; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 10px; MARGIN: 0px 0px 0px 38px; BORDER-LEFT: rgb(209,215,220) 1px solid; LINE-HEIGHT: 18px; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(250,250,250)"><SPAN 
  style="COLOR: black">pause&nbsp;&nbsp;</SPAN></LI></OL></DIV>
<P 
style="WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">&nbsp;此功能也可实现rar和zip的批量互转功能。</P>
<P 
style="WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">分享出来 
希望有用的朋友不用再浪费时间。</P>
<P 
style="WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"> 
&nbsp;</P></body>
</html>
