<HTML>
<HEAD>
<META HTTP-EQUIV=Content-Type CONTENT=text/html; charset=gb2312>
<title>在程序中注册BouncyCastleProvider</title>
<style type="text/css">
<!--
.9t {
	font-size: 9pt;
	color: #000000;
	font-family: "宋体";
}
-->
</style>
</HEAD>
<body bgcolor="#FFFFFF">
<table width="90%" border="0" align="center" >
  <tr>
    <td><PRE class="9t">
private static java.security.Provider provider = new org.bouncycastle.jce.provider.BouncyCastleProvider();

static {
  // Add the BouncyCastle provider to the list of security providers
  java.security.Security.addProvider(provider);
}

/**
     * Returns a new public &amp; private key with the specified algorithm (e.g. DSA, RSA, etc.).
     *
     * @param algorithm DSA, RSA, etc.
     * @param keysize   the keysize. This is an algorithm-specific metric, such as modulus
     *                  length, specified in number of bits.
     * @return a new public &amp; private key with the specified algorithm (e.g. DSA, RSA, etc.).
     * @throws GeneralSecurityException
     */
    private static KeyPair generateKeyPair(String algorithm, int keysize) throws GeneralSecurityException {
        KeyPairGenerator generator;
        if (provider == null) {
            generator = KeyPairGenerator.getInstance(algorithm);
        } else {
            generator = KeyPairGenerator.getInstance(algorithm, provider);
        }
        generator.initialize(keysize, new SecureRandom());
        return generator.generateKeyPair();
    }
 
</PRE></td>
  </tr>
</table>
</Body>
</HTML>
