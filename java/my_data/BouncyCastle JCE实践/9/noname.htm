<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<HTML xmlns:o = "urn:schemas-microsoft-com:office:office"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>CSDN_BouncyCastle JCE实践(六)</title><LINK 
href="csdn.css" rel=stylesheet></HEAD>

<BODY bottomMargin=0 aLink=#990000 bgColor=#ffffff leftMargin=0 topMargin=0 
rightMargin=0 marginwidth="0" marginheight="0"><!--StartFragment-->
<SCRIPT language=javascript1.2>
<!--
	var currentpos,timer; 
	function initialize() 
	{ 
	timer=setInterval('scrollwindow()',10);
	} 
	function sc(){
	clearInterval(timer);	
	}
	function scrollwindow() 
	{ 
	currentpos=document.body.scrollTop; 
	window.scroll(0,++currentpos); 
	if (currentpos != document.body.scrollTop) 
	sc();
	} 
	document.onmousedown=sc
	document.ondblclick=initialize
//-->
</SCRIPT>

<DIV align=center>
<STYLE>.title0 {
	FONT-WEIGHT: bold; FONT-SIZE: 17px; COLOR: #ffffff; FONT-FAMILY: arial; TEXT-DECORATION: none
}
A.title2:link {
	COLOR: #000000; TEXT-DECORATION: none
}
A.title2:visited {
	COLOR: #000000; TEXT-DECORATION: none
}
A.title2:active {
	COLOR: #ff0000; TEXT-DECORATION: none
}
A.title2:hover {
	COLOR: #ff0000; TEXT-DECORATION: none
}
</STYLE>

<TABLE cellSpacing=0 cellPadding=0 width=770 border=0>
<TBODY>
<TR>
<TD width=20 bgColor=#004d99 height=25></TD>
<TD bgColor=#004d99>&nbsp;&nbsp; <A href="http://www.csdn.net/member/login.asp"><FONT color=#ffff33>登 录..</FONT></A> &nbsp;&nbsp; <A href="http://www.csdn.net/member/zc.asp" 
target=_blank><FONT color=#ffff33>[注 册]</FONT></A> &nbsp;&nbsp; <A 
href="http://www.csdn.net/member/login.asp"><FONT color=#ffff33>忘记密码</FONT> 
</A>&nbsp;&nbsp; <A href="http://www.csdn.net/member/logonout.asp"><FONT color=#ffff33>注销登录</FONT> </A></TD>
<TD align=right width=20 bgColor=#990000><IMG src="top_1.gif" 
width=20 height=25></TD>
<FORM action=http://www.csdn.net/search_ok.asp method=post target=_blank>
<TD align=right width=250 bgColor=#009999><FONT color=#ffffff><FONT color=#ffffff><INPUT class=FormText_1 size=15 name=search> <SELECT 
class=FormText_1 name=type> <OPTION value=1 selected>新闻标题</OPTION> <OPTION 
value=2>软件名称</OPTION> <OPTION value=3>商品名称</OPTION> <OPTION 
value=4>文档标题</OPTION> <OPTION value=6>职位名称</OPTION></SELECT> </FONT><INPUT class=td3 type=submit value="搜 索" name=Submit>&nbsp; 
</FONT></TD></FORM></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width=770 border=0>
<TBODY>
<TR>
<TD align=center width=150 height=70><IMG src="csdn.gif" 
width=120 height=60></TD>
<TD align=center width=470>
<SCRIPT language=javascript>
	var rand = Math.random().toString(); 
	var ordval = parseInt(rand.substring(2,4)); 
	function Showad(width)
	{
		if(width=='468')
		{
				document.write("<a href='http://www.dearbook.com.cn/' target='_blank'><OBJECT classid= 'clsid:D27CDB6E-AE6D-11cf-96B8-444553540000'codebase='http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0' WIDTH=468 HEIGHT=60><PARAM NAME=movie VALUE='/adv//468x60.swf'> <PARAM NAME=quality VALUE=high> <EMBED src='468x60.swf' quality=high border=0 WIDTH=468 HEIGHT=60 TYPE= 'application/x-shockwave-flash'PLUGINSPAGE='http://www.macromedia.com/shockwave/download/index.cgi?P1_Prod_Version=ShockwaveFlash'></EMBED></OBJECT></a>");
				return;
		}
		if(width=='120')
		{
		}
		return;
	}
Showad('468')</SCRIPT>
<A href="http://www.dearbook.com.cn/" target=_blank><EMBED 
pluginspage=http://www.macromedia.com/shockwave/download/index.cgi?P1_Prod_Version=ShockwaveFlash 
src=468x60.swf width=468 height=60 type=application/x-shockwave-flash 
border="0" quality="high"></EMBED></A></TD>
<TD align=center width=150>
<SCRIPT>Showad('120')</SCRIPT>
</TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width=770 border=0>
<TBODY>
<TR>
<TD align=center width=770 bgColor=#000000 colSpan=2 height=1></TD></TR>
<TR>
<TD align=center width=150 bgColor=#004d99 height=28><FONT class=title0>csdn.net</FONT></TD>
<TD align=center width=620>
<SCRIPT src="navigation1.js"></SCRIPT>

<TABLE height=40 cellSpacing=0 cellPadding=0 width="100%" border=0>
<TBODY>
<TR align=center>
<TD><A class=title2 href="http://www.csdn.net/" target=_blank>首&nbsp;页</A></TD>
<TD width=10>|</TD>
<TD><A class=title2 href="http://www.dearbook.com.cn/" target=_blank><FONT color=red>第二书店</FONT></A></TD>
<TD width=10>|</TD>
<TD><A class=title2 href="http://expert.csdn.net/" target=_blank>论&nbsp;坛</A></TD>
<TD width=10>|</TD>
<TD><A class=title2 href="http://www.csdn.net/subject/" 
target=_blank>专&nbsp;题</A></TD>
<TD width=10>|</TD>
<TD><A class=title2 href="http://www.csdn.net/prime/" target=_blank>精&nbsp;华</A></TD>
<TD width=10>|</TD>
<TD><A class=title2 href="http://www.csdn.net/sun/" target=_blank>SUN</A></TD>
<TD width=10>|</TD>
<TD><A class=title2 href="http://www.csdn.net/ibmc/" target=_blank>IBM</A></TD>
<TD width=10>|</TD>
<TD><A class=title2 href="http://www.csdn.net/microsoft/" 
target=_blank>微&nbsp;软</A></TD>
<TD width=10>|</TD>
<TD><A class=title2 href="http://www.csdn.net/wicresoft/" 
target=_blank>微&nbsp;创</A></TD>
<TD width=10>|</TD>
<TD><A class=title2 href="http://www.csdn.net/magazine/" 
target=_blank>《程序员》</A></TD>
<TD width=10>|</TD>
<TD><A class=title2 href="http://www.csdn.net/vote/" target=_blank>调&nbsp;查</A></TD>
<TD width=10>|</TD>
<TD><A class=title2 href="http://chat.csdn.net/" target=_blank>聊&nbsp;天</A></TD>
<TD width=10>|</TD>
<TD><A class=title2 href="http://www.csdn.net/ypage/" target=_blank><FONT color=red>黄&nbsp;页</FONT></A></TD></TR>
<TR align=center>
<TD><A class=title2 href="http://www.csdn.net/news/" target=_blank>新&nbsp;闻</A></TD>
<TD width=10>|</TD>
<TD><A class=title2 href="http://www.donews.com/" target=_blank>Donews</A></TD>
<TD width=10>|</TD>
<TD><A class=title2 href="http://www.csdn.net/develop/" 
target=_blank>文&nbsp;档</A></TD>
<TD width=10>|</TD>
<TD><A class=title2 href="http://www.csdn.net/FAQ/" target=_blank>FAQ</A></TD>
<TD width=10>|</TD>
<TD><A class=title2 href="http://www.csdn.net/csdnColumn/" 
target=_blank>专&nbsp;栏</A></TD>
<TD width=10>|</TD>
<TD><A href="http://www.csdn.net/commerce/#job" target=_blank>人&nbsp;才</A></TD>
<TD width=10>|</TD>
<TD><A class=title2 href="http://www.csdn.net/commerce/#educate" 
target=_blank>培&nbsp;训</A></TD>
<TD width=10>|</TD>
<TD><A class=title2 href="http://www.csdn.net/mobile/" target=_blank><FONT color=red>移&nbsp;动</FONT></A></TD>
<TD width=10>|</TD>
<TD><A class=title2 href="http://www.csdn.net/ptpress/" 
target=_blank>人&nbsp;邮</A></TD>
<TD width=10>|</TD>
<TD><A class=title2 href="file:///J:/CSDNMagazine/csdn_magazine.shtm" target=_blank><FONT color=red>《开发高手》</FONT></A></TD>
<TD width=10>|</TD>
<TD><A class=title2 href="http://www.csdn.net/search.asp" 
target=_blank>搜&nbsp;索</A></TD>
<TD width=10>|</TD>
<TD><A class=title2 href="http://www.csdn.net/cnshare/" 
target=_blank>软&nbsp;件</A></TD>
<TD width=10>|</TD>
<TD><A class=title2 href="http://www.csdn.net/member.shtm" 
target=_blank>会&nbsp;员</A></TD></TR></TBODY></TABLE></TD></TR>
<TR>
<TD align=center width=770 bgColor=#000000 colSpan=2 
height=1></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width=770 border=0>
<TBODY>
<TR>
<TD width=10 bgColor=#f3f9fc height=23></TD>
<TD bgColor=#f3f9fc>
<MARQUEE onmouseover=this.stop() onmouseout=this.start() scrollAmount=5 
scrollDelay=80>
<SCRIPT src="marquee.htm"></SCRIPT>
·[<A href="http://www.csdn.net/news/newstopic/14/14846.shtml" 
target=_blank><B>eWeek:Borland连丢大将</B></A>] [<A 
href="http://www.csdn.net/news/newstopic/14/14845.shtml" target=_blank>CTO Blake 
Stone辞职</A>] [<A href="http://expert.csdn.net/Expert/TopicView.asp?id=2712081" 
target=_blank><FONT color=blue>讨论</FONT></A>] ·<A 
href="http://www.dearbook.com.cn/Guide/ViewGuide.aspx?GuideID=94" 
target=_blank><FONT color=red>关注2004年度计算机专业考试</FONT></A> ·<A 
href="http://www.csdn.net/news/newstopic/14/14821.shtml" 
target=_blank>Oracle欲以94亿美元收购仁科</A> ·<A 
href="http://www.csdn.net/Develop/article/24/24061.shtm" 
target=_blank>测试驱动的开发系列(1)</A> ·<A 
href="http://www.csdn.net/Develop/article/24/24018.shtm" target=_blank>Jakarta 
Common Digester 应用</A> ·<A 
href="http://www.csdn.net/Develop/article/24/24035.shtm" 
target=_blank>PHP4之真OO</A> ·<A 
href="http://www.csdn.net/Develop/article/23/23992.shtm" 
target=_blank>一次编写，随处运行</A> ·<A 
href="http://www.csdn.net/Develop/article/23/23763.shtm" 
target=_blank>超越模板引擎</A> ·<B>ERP实践：</B><A 
href="http://www.csdn.net/Develop/article/24/24036.shtm" 
target=_blank>多级分类档案级联删除技术</A> <A 
href="http://www.csdn.net/Develop/article/23/23546.shtm" 
target=_blank>ID号自动编码技术</A> ·<A 
href="http://www.csdn.net/news/newstopic/14/14796.shtml" 
target=_blank>金山《剑网》官方网站2度被黑</A> ·<A 
href="http://www.csdn.net/develop/article/23/23979.shtm" target=_blank> <FONT color=blue>读者盛赞Inside VCL，李维一一作答</FONT></A> ·<A 
href="http://www.dearbook.com.cn/Guide/ViewGuide.aspx?GuideID=89" target=_blank> 
<FONT color=red>2004 Jolt大奖入围图书</FONT></A> ·<A 
href="http://www.csdn.net/develop/article/23/23977.shtm" target=_blank> 
gzip-1.2.4程序分析</A> ·<A 
href="http://www.microsoft.com/china/community/content/news/mvp20040128.aspx" 
target=_blank> 微软MVP新一届(2004.1)名单揭晓</A> ·<A 
href="http://www.dearbook.com.cn/market/microsoft/" target=_blank> 
社区之星联动读书计划</A> ·<B>关注Ruby语言</B>：<A 
href="http://www.csdn.net/Develop/article/23/23820.shtm" 
target=_blank>Matz关于技术的对话</A> <A 
href="http://www.csdn.net/Develop/article/23/23834.shtm" 
target=_blank>blocks和Closure结构</A> ·<A href="http://www.csdn.net/subject/327/" 
target=_blank> <FONT color=blue>CSDN专题:网格计算</FONT></A> ·<A 
href="http://www.csdn.net/develop/article/23/23461.shtm" target=_blank> 
CSDN最新推出RSS客户端订阅</A> ·<A href="http://www.dearbook.com.cn/" target=_blank> <FONT color=red>Dearbook新春货到付款免配送费</FONT></A></MARQUEE></TD>
<TD align=right width=101 bgColor=#f3f9fc>
<SCRIPT> document.write("<imgsrc=pageview1.asp_columnid=4&itemid=11 border=0 width=0 height=0>");</SCRIPT>
<IMG border=0 
src="pageview1.asp_columnid=4&amp;itemid=11" width=0 
height=0> <B>
<SCRIPT language=JavaScript>
			<!--
			document.ns = navigator.appName == "Netscape"
			tmpDate = new Date();
			date = tmpDate.getDate();
			month= tmpDate.getMonth() + 1 ; 
			if(document.ns)
			{
				year1=tmpDate.getYear()
				year= year1.toString().substr(1,2);
			}
			else
				year= tmpDate.getYear();
			
			document.write(year);
			document.write(".");
			document.write(month);
			document.write(".");
			document.write(date);
			// -->
			</SCRIPT>
2007.3.27 </B>&nbsp;&nbsp;</TD></TR>
<TR bgColor=#999999>
<TD colSpan=3 height=1></TD></TR></TBODY></TABLE>
<TABLE width=770 border=0>
<TBODY>
<TR>
<TD class=td1 vAlign=top align=center width=150 bgColor=#fafafa><BR><!--广告条开始//-->

<TABLE cellSpacing=1 cellPadding=0 width=120 border=0>
<TBODY>
<TR>
<TD><IMG src="jspd_wdzx_flgg.gif"></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=1 cellPadding=0 width=120 border=0>
<TBODY>
<TR>
<TD align=center bgColor=#588fc7 height=20><FONT color=#ffffff>— 人才招聘 
—</FONT></TD></TR>
<TR>
<TD height=10></TD></TR>
<TR>
<TD><A title="Samsung OpenTide China(北京)" 
href="http://www.csdn.net/job/person/corp_jobs.asp?corp_id=2543" 
target=_blank>Samsung OpenTide...</A></TD></TR>
<TR>
<TD><A title=北京北阳电子技术有限公司(北京) 
href="http://www.csdn.net/job/person/corp_jobs.asp?corp_id=2455" 
target=_blank>北京北阳电子技术...</A></TD></TR>
<TR>
<TD><A title=北京线线通科技开发有限公司(可乐吧)(北京) 
href="http://www.csdn.net/job/person/corp_jobs.asp?corp_id=1761" 
target=_blank>北京线线通科技开...</A></TD></TR>
<TR>
<TD><A title=明日工作室（上海）电子技术有限公司(上海) 
href="http://www.csdn.net/job/person/corp_jobs.asp?corp_id=2453" 
target=_blank>明日工作室（上海...</A></TD></TR>
<TR>
<TD><A title=北京飞天诚信科技有限公司(北京) 
href="http://www.csdn.net/job/person/corp_jobs.asp?corp_id=1407" 
target=_blank>北京飞天诚信科技...</A></TD></TR>
<TR>
<TD><A title=重庆海特科技发展有限公司(重庆) 
href="http://www.csdn.net/job/person/corp_jobs.asp?corp_id=989" 
target=_blank>重庆海特科技发展...</A></TD></TR>
<TR>
<TD><A title=北京色诺芬信息服务公司(北京) 
href="http://www.csdn.net/job/person/corp_jobs.asp?corp_id=2149" 
target=_blank>北京色诺芬信息服...</A></TD></TR>
<TR>
<TD><A title=武汉紫龙科技有限公司(武汉) 
href="http://www.csdn.net/job/person/corp_jobs.asp?corp_id=2366" 
target=_blank>武汉紫龙科技有限...</A></TD></TR>
<TR>
<TD><A title=北京奥维在线软件技术发展有限公司(北京) 
href="http://www.csdn.net/job/person/corp_jobs.asp?corp_id=2092" 
target=_blank>北京奥维在线软件...</A></TD></TR>
<TR>
<TD><A title=广西怡海信息产业发展有限公司(南宁) 
href="http://www.csdn.net/job/person/corp_jobs.asp?corp_id=2444" 
target=_blank>广西怡海信息产业...</A></TD></TR>
<TR>
<TD><A title=飞迈影视制作公司(上海) 
href="http://www.csdn.net/job/person/corp_jobs.asp?corp_id=2425" 
target=_blank>飞迈影视制作公司...</A></TD></TR>
<TR>
<TD><A title=人民网(香港)有限公司(深圳) 
href="http://www.csdn.net/job/person/corp_jobs.asp?corp_id=2422" 
target=_blank>人民网(香港)有限...</A></TD></TR>
<TR>
<TD><A title=北京世纪百合科技有限公司(北京) 
href="http://www.csdn.net/job/person/corp_jobs.asp?corp_id=2402" 
target=_blank>北京世纪百合科技...</A></TD></TR>
<TR>
<TD><A title=北京蓝天中交科技发展有限公司(www.ifidic.com)(广州) 
href="http://www.csdn.net/job/person/corp_jobs.asp?corp_id=2405" 
target=_blank>北京蓝天中交科技...</A></TD></TR>
<TR>
<TD><A title=TOM互联网事业集团(北京) 
href="http://www.csdn.net/job/person/corp_jobs.asp?corp_id=2359" 
target=_blank>TOM互联网事业集团...</A></TD></TR>
<TR>
<TD><A title=北京连邦软件学校(北京) 
href="http://www.csdn.net/job/person/corp_jobs.asp?corp_id=2386" 
target=_blank>北京连邦软件学校...</A></TD></TR>
<TR>
<TD height=10></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=1 cellPadding=0 width=120 border=0>
<TBODY>
<TR>
<TD align=center bgColor=#588fc7 height=20><FONT color=#ffffff>— 热销商品 
—</FONT></TD></TR>
<TR>
<TD height=10></TD></TR>
<TR>
<TD><A title=《Oracle9i实务管理讲座--系统核心篇》 
href="http://www.csdn.net/buy/product/product.asp?id=1456" 
target=_blank>《Oracle9i实务管...</A></TD></TR>
<TR>
<TD><A title=《过河卒》 href="http://www.csdn.net/buy/product/product.asp?id=1453" 
target=_blank>《过河卒》</A></TD></TR>
<TR>
<TD><A title=《.NET系统架构与开发》 
href="http://www.csdn.net/buy/product/product.asp?id=1454" 
target=_blank>《.NET系统架构与...</A></TD></TR>
<TR>
<TD><A title=《JBuilder实用技术手册》 
href="http://www.csdn.net/buy/product/product.asp?id=1455" 
target=_blank>《JBuilder实用技...</A></TD></TR>
<TR>
<TD><A title=《Java夜未眠》 
href="http://www.csdn.net/buy/product/product.asp?id=1452" 
target=_blank>《Java夜未眠》</A></TD></TR>
<TR>
<TD height=10></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=1 cellPadding=0 width=120 border=0>
<TBODY>
<TR>
<TD align=center bgColor=#588fc7 height=20><FONT color=#ffffff>— 培训信息 
—</FONT></TD></TR>
<TR>
<TD height=10></TD></TR>
<TR>
<TD><A title=中国思科培训网(Cisco认证) 
href="http://www.csdn.net/educate/organ/0/125.shtm" 
target=_blank>中国思科培训网(C...</A></TD></TR>
<TR>
<TD><A title=UML软件工程组织(软件工程) href="http://www.csdn.net/educate/organ/0/124.shtm" 
target=_blank>UML软件工程组织(...</A></TD></TR>
<TR>
<TD><A title=天盈隆网络技术培训中心(Cisco认证) 
href="http://www.csdn.net/educate/organ/0/69.shtm" 
target=_blank>天盈隆网络技术培...</A></TD></TR>
<TR>
<TD><A title=美国Softtech公司北京分公司(软件工程) 
href="http://www.csdn.net/educate/organ/0/73.shtm" 
target=_blank>美国Softtech公司...</A></TD></TR>
<TR>
<TD><A title="北大青鸟APTECH深圳大区域培训中心(程序设计; 软件工程)" 
href="http://www.csdn.net/educate/organ/0/97.shtm" 
target=_blank>北大青鸟APTECH深...</A></TD></TR>
<TR>
<TD><A title=北京中软总公司计算培训中心(SUN认证) 
href="http://www.csdn.net/educate/organ/0/47.shtm" 
target=_blank>北京中软总公司计...</A></TD></TR>
<TR>
<TD><A title="维新计算机培训中心(程序设计; 软件工程)" 
href="http://www.csdn.net/educate/organ/0/56.shtm" 
target=_blank>维新计算机培训中...</A></TD></TR>
<TR>
<TD height=10></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=1 cellPadding=0 width=120 border=0>
<TBODY>
<TR>
<TD align=center bgColor=#588fc7 height=20><FONT color=#ffffff>— 图书信息 
—</FONT></TD></TR>
<TR>
<TD height=10></TD></TR>
<TR>
<TD><A title=软件创富 href="http://www.csdn.net/book/books/0/2.shtm" 
target=_blank>软件创富</A></TD></TR>
<TR>
<TD><A title="Delphi 深度探索" href="http://www.csdn.net/book/books/0/4.shtm" 
target=_blank>Delphi 深度探索</A></TD></TR>
<TR>
<TD><A title=C#精髓 href="http://www.csdn.net/book/books/0/1.shtm" 
target=_blank>C#精髓</A></TD></TR>
<TR>
<TD><A title=Refactoring href="http://www.csdn.net/book/books/0/12.shtm" 
target=_blank>Refactoring</A></TD></TR>
<TR>
<TD><A title="The Java Programming Language (3rd Edition)" 
href="http://www.csdn.net/book/books/0/13.shtm" target=_blank>The Java 
Program...</A></TD></TR>
<TR>
<TD height=10></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=1 cellPadding=0 width=120 border=0>
<TBODY>
<TR>
<TD height=10></TD></TR>
<TR>
<TD><A href="mailto:zdg@csdn.net"><IMG 
border=0 src="jspd_wdzx_sqgg_ad.gif"></A></TD></TR>
<TR>
<TD height=10></TD></TR></TBODY></TABLE><!--广告条结束//--></TD>
<TD vAlign=top align=center width=620><!--文章说明信息开始//-->
<TABLE cellSpacing=0 cellPadding=0 width=600 bgColor=#eeeeee border=0>
<TBODY>
<TR bgColor=#ffffff>
<TD align=center width=50 height=10></TD>
<TD align=right><A href="http://www.csdn.net/">CSDN</A> - <A 
href="http://www.csdn.net/develop/">文档中心</A> - <FONT color=#003399>Java</FONT>&nbsp;&nbsp;&nbsp;&nbsp;</TD></TR>
<TR>
<TD height=5 ></TD>
<TD align=center width=500  td <></TD>
<TR>
<TD align=center bgColor=#003399 height=10><FONT color=#ffffff>标题</FONT></TD>
<TD><B>&nbsp;&nbsp;&nbsp;&nbsp;BouncyCastle JCE实践(六)</B>&nbsp;&nbsp;&nbsp;&nbsp;hongbo781202（原作）</TD></TR>
<TR>
<TD align=center height=5></TD>
<TD align=center width=500></TD></TR>
<TR>
<TD align=center bgColor=#003399><FONT color=#ffffff>关键字</FONT></TD>
<TD width=500>&nbsp;&nbsp;&nbsp;&nbsp;JCE</TD></TR>
<TR>
<TD align=center height=5></TD>
<TD align=center width=500></TD></TR></TBODY></TABLE><!--文章说明信息结束//-->
<TABLE width=600 border=0>
<TBODY>
<TR>
<TD align=left><!--内容开始//--><BR>
<P></P>
<P class=MsoNormal style="TEXT-ALIGN: center" align=center><B 
style="mso-bidi-font-weight: normal"><SPAN 
style="FONT-SIZE: 14pt; FONT-FAMILY: 黑体; mso-ascii-font-family: 'Times New Roman'; mso-bidi-font-size: 12.0pt">签名的实现过程</SPAN></B><B 
style="mso-bidi-font-weight: normal"><SPAN lang=EN-US 
style="FONT-SIZE: 14pt; mso-bidi-font-size: 12.0pt; mso-fareast-font-family: 黑体"></SPAN></B></P>
<P class=MsoNormal 
style="MARGIN-LEFT: 42pt; LINE-HEIGHT: 20pt; TEXT-INDENT: -18pt; mso-list: l0 level1 lfo4; mso-layout-grid-align: none; tab-stops: list 42.0pt; mso-line-height-rule: exactly"><SPAN 
lang=EN-US style="FONT-SIZE: 12pt; FONT-FAMILY: 宋体">1）</SPAN><SPAN 
style="FONT-SIZE: 12pt; FONT-FAMILY: 宋体">读取自己的私钥<SPAN 
lang=EN-US></SPAN></SPAN></P>
<P class=MsoNormal 
style="LINE-HEIGHT: 20pt; mso-layout-grid-align: none; mso-line-height-rule: exactly"><SPAN 
lang=EN-US style="FONT-SIZE: 12pt; FONT-FAMILY: 宋体"><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; 
</SPAN>对于自己的私钥文件，要用File类来声明。读取时，将用FileInputStream格式来作为输入流。而读出的密钥是字节数组，所以应该将读出的密钥用ByteArrayOutStream来保存，再用toByteArray格式来将它转化为字节数组。</SPAN></P>
<P class=MsoNormal 
style="LINE-HEIGHT: 20pt; TEXT-INDENT: 24pt; mso-layout-grid-align: none; mso-line-height-rule: exactly"><SPAN 
style="FONT-SIZE: 12pt; FONT-FAMILY: 宋体">生成签名要使用自己</SPAN><SPAN 
style="FONT-SIZE: 12pt; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">的私钥，而私钥使用</SPAN><SPAN 
lang=EN-US style="FONT-SIZE: 12pt">PKCS8#</SPAN><SPAN 
style="FONT-SIZE: 12pt; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">编码。所以我们还要将</SPAN><SPAN 
style="FONT-SIZE: 12pt; FONT-FAMILY: 宋体">字节数组转化为</SPAN><SPAN lang=EN-US 
style="FONT-SIZE: 12pt">PKCS8#</SPAN><SPAN 
style="FONT-SIZE: 12pt; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">编码形式。实现方法如下：</SPAN><SPAN 
lang=EN-US style="FONT-SIZE: 12pt"></SPAN></P>
<P class=MsoNormal 
style="LINE-HEIGHT: 20pt; TEXT-INDENT: 24pt; mso-layout-grid-align: none; mso-line-height-rule: exactly"><SPAN 
lang=EN-US style="FONT-SIZE: 12pt; FONT-FAMILY: 宋体">PKCS8EncodedKeySpec 
keyspec=new PKCS8EncodedKeySpec(keybytes);</SPAN></P>
<P class=MsoNormal 
style="LINE-HEIGHT: 20pt; TEXT-INDENT: 24pt; mso-layout-grid-align: none; mso-line-height-rule: exactly"><SPAN 
lang=EN-US style="FONT-SIZE: 12pt; FONT-FAMILY: 宋体">KeyFactory 
keyfactory=KeyFactory.getInstance("RSA");</SPAN></P>
<P class=MsoNormal 
style="LINE-HEIGHT: 20pt; TEXT-INDENT: 24pt; mso-layout-grid-align: none; mso-line-height-rule: exactly"><SPAN 
lang=EN-US 
style="FONT-SIZE: 12pt; FONT-FAMILY: 宋体">syprivatekey=keyfactory.generatePrivate(keyspec);</SPAN></P>
<P class=MsoNormal 
style="LINE-HEIGHT: 20pt; TEXT-INDENT: 24pt; mso-layout-grid-align: none; mso-line-height-rule: exactly"><SPAN 
style="FONT-SIZE: 12pt; FONT-FAMILY: 宋体">其中<SPAN 
lang=EN-US>keybytes是从原文中读出的字节数组形式的密钥。用KeyFactory对象的实例化方法来指定算法，并用generatePrivate方法产生</SPAN></SPAN><SPAN 
lang=EN-US style="FONT-SIZE: 12pt">PKCS8#</SPAN><SPAN 
style="FONT-SIZE: 12pt; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">编码的私钥。</SPAN><SPAN 
lang=EN-US style="FONT-SIZE: 12pt"></SPAN></P>
<P class=MsoNormal 
style="MARGIN-LEFT: 42pt; LINE-HEIGHT: 20pt; TEXT-INDENT: -18pt; mso-list: l0 level1 lfo4; mso-layout-grid-align: none; tab-stops: list 42.0pt; mso-line-height-rule: exactly"><SPAN 
lang=EN-US style="FONT-SIZE: 12pt">2）</SPAN><SPAN 
style="FONT-SIZE: 12pt; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">从对话框中取得要签名的文件</SPAN><SPAN 
lang=EN-US style="FONT-SIZE: 12pt"></SPAN></P>
<P class=MsoNormal 
style="MARGIN-LEFT: 24pt; LINE-HEIGHT: 20pt; mso-layout-grid-align: none; mso-line-height-rule: exactly"><SPAN 
style="FONT-SIZE: 12pt; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">该步骤的实现比较简单，不做过多说明。</SPAN><SPAN 
lang=EN-US style="FONT-SIZE: 12pt"></SPAN></P>
<P class=MsoNormal 
style="MARGIN-LEFT: 42pt; LINE-HEIGHT: 20pt; TEXT-INDENT: -18pt; mso-list: l0 level1 lfo4; mso-layout-grid-align: none; tab-stops: list 42.0pt; mso-line-height-rule: exactly"><SPAN 
lang=EN-US style="FONT-SIZE: 12pt; FONT-FAMILY: 宋体">3）</SPAN><SPAN 
style="FONT-SIZE: 12pt; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">将文件内容读取为</SPAN><SPAN 
style="FONT-SIZE: 12pt; FONT-FAMILY: 宋体">字节数组格式<SPAN 
lang=EN-US></SPAN></SPAN></P>
<P class=MsoNormal 
style="MARGIN-LEFT: 24pt; LINE-HEIGHT: 20pt; mso-layout-grid-align: none; mso-line-height-rule: exactly"><SPAN 
style="FONT-SIZE: 12pt; FONT-FAMILY: 宋体">因为签名时<SPAN 
lang=EN-US>Signature类的Update()方法的参数是字节数组形式，所以要求</SPAN></SPAN></P>
<P class=MsoNormal 
style="LINE-HEIGHT: 20pt; mso-layout-grid-align: none; mso-line-height-rule: exactly"><SPAN 
style="FONT-SIZE: 12pt; FONT-FAMILY: 宋体">先将原文读为字节数组。并且，在此处可以获得原文的内容长度。<SPAN 
lang=EN-US></SPAN></SPAN></P>
<P class=MsoNormal 
style="MARGIN-LEFT: 42pt; LINE-HEIGHT: 20pt; TEXT-INDENT: -18pt; mso-list: l0 level1 lfo4; mso-layout-grid-align: none; tab-stops: list 42.0pt; mso-line-height-rule: exactly"><SPAN 
lang=EN-US style="FONT-SIZE: 12pt; FONT-FAMILY: 宋体">4）</SPAN><SPAN 
style="FONT-SIZE: 12pt; FONT-FAMILY: 宋体">生成签名<SPAN 
lang=EN-US></SPAN></SPAN></P>
<P class=MsoNormal 
style="MARGIN-LEFT: 24pt; LINE-HEIGHT: 20pt; mso-layout-grid-align: none; mso-line-height-rule: exactly"><SPAN 
style="FONT-SIZE: 12pt; FONT-FAMILY: 宋体">按照前面的描述，先用<SPAN 
lang=EN-US>Signature类的getInstance()方法指定MD5WithRSA</SPAN></SPAN></P>
<P class=MsoNormal 
style="LINE-HEIGHT: 20pt; mso-layout-grid-align: none; mso-line-height-rule: exactly"><SPAN 
style="FONT-SIZE: 12pt; FONT-FAMILY: 宋体">算法，然后用前面得到的私钥作为参数调用<SPAN 
lang=EN-US>initSign()方法来初始化，最后用原文作为参数调用update()方法来传送数据，用字节数组形式的私钥作为参数调用Sign()方法来产生签名。</SPAN></SPAN></P>
<P class=MsoNormal 
style="LINE-HEIGHT: 20pt; TEXT-INDENT: 24pt; mso-layout-grid-align: none; mso-line-height-rule: exactly; mso-char-indent-count: 2.0; mso-char-indent-size: 12.0pt"><SPAN 
style="FONT-SIZE: 12pt; FONT-FAMILY: 宋体">将生成的签名按照前面设计的文件格式写入文件流中，就完成了签名的全部工作。签名的实现过程可用下面的图来表示：</SPAN></P>
<P class=MsoNormal 
style="LINE-HEIGHT: 20pt; TEXT-INDENT: 24pt; mso-layout-grid-align: none; mso-line-height-rule: exactly; mso-char-indent-count: 2.0; mso-char-indent-size: 12.0pt"><SPAN 
style="FONT-SIZE: 12pt; FONT-FAMILY: 宋体"><SPAN lang=EN-US><o:p><IMG border=0 
hspace=0 
alt="" 
src="CSDN_Dev_Image_2004-2-81656230.bmp" align=baseline></o:p></SPAN></SPAN></P>
<P class=MsoNormal 
style="LINE-HEIGHT: 20pt; TEXT-INDENT: 24pt; mso-layout-grid-align: none; mso-line-height-rule: exactly"><SPAN 
lang=EN-US style="FONT-SIZE: 12pt; FONT-FAMILY: 宋体"><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN></SPAN><B><SPAN style="FONT-FAMILY: 宋体">图 
数字签名过程<SPAN lang=EN-US></SPAN></SPAN></B></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN 
style="FONT-SIZE: 12pt; FONT-FAMILY: 宋体">代码实现如下<SPAN 
lang=EN-US>:</SPAN></SPAN><B><SPAN lang=EN-US 
style="FONT-FAMILY: 宋体"></SPAN></B></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US>//</SPAN><SPAN 
style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">读取私钥</SPAN><SPAN 
lang=EN-US></SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>PrivateKey 
syprivatekey=null;</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>File syfile=new File("c:\\</SPAN><SPAN 
style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">安全文件</SPAN><SPAN 
lang=EN-US>\\"+misClass.username+"\\</SPAN><SPAN 
style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">非对称</SPAN><SPAN 
lang=EN-US>\\</SPAN><SPAN 
style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">本人公私钥</SPAN><SPAN 
lang=EN-US>\\yhb.private");</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>try</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>{</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>FileInputStream fis=new 
FileInputStream(syfile);</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>ByteArrayOutputStream baos=new 
ByteArrayOutputStream();</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN 
lang=EN-US></SPAN>&nbsp;</P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>int thebyte=0;</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>while((thebyte=fis.read())!=-1)</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>{baos.write(thebyte);</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>}</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>fis.close();</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>byte[] 
keybytes=baos.toByteArray();</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>baos.close();</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN 
lang=EN-US></SPAN>&nbsp;</P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>PKCS8EncodedKeySpec keyspec=new 
PKCS8EncodedKeySpec(keybytes);</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>KeyFactory 
keyfactory=KeyFactory.getInstance("RSA");</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>syprivatekey=keyfactory.generatePrivate(keyspec);</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </SPAN>}</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </SPAN>catch(Exception e9)</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>{</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>System.out.print("error when read the rsa 
private key");</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>System.exit(0);</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>}</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>//</SPAN><SPAN 
style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">从对话框中取得要签名的文件</SPAN><SPAN 
lang=EN-US></SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>File file=new 
File(dirstring1,string1);</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>String 
filename=file.getName();</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>//</SPAN><SPAN 
style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">首先将文件读为</SPAN><SPAN 
lang=EN-US>byte[]</SPAN><SPAN 
style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">对象</SPAN><SPAN 
lang=EN-US></SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </SPAN>int 
len=(int)file.length();</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </SPAN>if(len&gt;100000000)</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </SPAN>{System.out.println("the file length is too 
long!");</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </SPAN>System.exit(0);</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </SPAN>}</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </SPAN>byte[] inbuf=new 
byte[len];</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </SPAN>try{</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </SPAN>FileInputStream instream=new 
FileInputStream(file);</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </SPAN>int 
inbytes=instream.available();</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </SPAN>//inbuf[]=new 
byte[inbytes];</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </SPAN>int 
bytesread=instream.read(inbuf,0,inbytes);</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </SPAN>instream.close();</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; 
</SPAN>//System.out.println(inbuf);</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </SPAN>}</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </SPAN>catch(Exception eq2)</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </SPAN>{</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </SPAN>System.out.println("error when change the 
file to byte[]");</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </SPAN>System.exit(0);</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </SPAN>}</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </SPAN>//</SPAN><SPAN 
style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">签名的具体过程</SPAN><SPAN 
lang=EN-US></SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </SPAN>try{</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </SPAN>//byte[] signaturebytes=new 
byte[150];</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </SPAN>Signature 
sig=Signature.getInstance("MD5WithRSA");</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; 
</SPAN>sig.initSign(syprivatekey);</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </SPAN>sig.update(inbuf);</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </SPAN>byte[] 
signaturebytes=sig.sign();</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>//</SPAN><SPAN 
style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">写入对象流中</SPAN><SPAN 
lang=EN-US></SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp; </SPAN>DataOutputStream outfile=new 
DataOutputStream(new FileOutputStream(</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>"c:\\</SPAN><SPAN 
style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">安全文件</SPAN><SPAN 
lang=EN-US>\\</SPAN><SPAN 
style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">文件</SPAN><SPAN 
lang=EN-US>\\"+filename+".yhb3"));</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; 
</SPAN>outfile.writeInt(signaturebytes.length);</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; 
</SPAN>outfile.write(signaturebytes);</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; 
</SPAN>outfile.writeInt(len);</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </SPAN>outfile.write(inbuf);</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </SPAN>outfile.close();</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </SPAN>}</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </SPAN>catch(Exception eh3)</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </SPAN>{</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </SPAN>System.out.println("error when generate the 
outfile");</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </SPAN>System.exit(0);</SPAN></P>
<P class=MsoNormal style="TEXT-INDENT: 21pt"><SPAN lang=EN-US><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; 
</SPAN>}</SPAN></P><BR><!--内容结束//--></TD></TR></TBODY></TABLE><BR>
<TABLE width=600 border=0>
<TBODY>
<TR>
<TD>作者相关文章： 
<LI><A href="http://www.csdn.net/develop/article/24/24137.shtm" 
target=_blank>BouncyCastle JCE实践(五)<FONT color=#ff0000>(原作)</FONT></A> 
<LI><A href="http://www.csdn.net/develop/article/24/24136.shtm" 
target=_blank>BouncyCastle JCE实践(四)<FONT color=#ff0000>(原作)</FONT></A> 
<LI><A href="http://www.csdn.net/develop/article/24/24134.shtm" 
target=_blank>BouncyCastle JCE实践(三)<FONT color=#ff0000>(原作)</FONT></A> 
</LI></TD></TR></TBODY></TABLE><BR>
<TABLE width=600 border=0>
<TBODY>
<TR>
<TD>其它相关文章： 
<LI><A href="http://www.csdn.net/develop/article/11/11898.shtm" 
target=_blank>简单加密/解密方法包装, 含encode(),decode(),md5()<FONT color=#ff0000>(原作)</FONT></A> </LI></TD></TR></TBODY></TABLE><BR>
<TR></TD></TR></TBODY></TABLE><BR><!--文章评论开始//-->
<TABLE cellSpacing=0 cellPadding=0 width=770 align=center bgColor=#006699 
border=0>
<TBODY>
<TR bgColor=#006699>
<TD id=white align=center bgColor=#006699><FONT color=#ffffff>对该文的评论</FONT></TD>
<TD align=center><!--文章人气开始//-->
<SCRIPT src="readnum.htm"></SCRIPT>
<FONT color=#ffffff>人气：101</FONT> 
  <!--文章人气开始//--></TD></TR></TBODY></TABLE>
<SCRIPT language=javascript>
<!--
function isEmpty(s)
{  
	return ((s == null) || (s.length == 0))
}
function submit1()
{
 if (document.add_critique.csdnpassword.value != '_xxx_no') 
  {
   if (isEmpty(document.add_critique.csdnname.value) || isEmpty(document.add_critique.csdnpassword.value) || isEmpty(document.add_critique.critique_content.value))
   {
      alert('登陆名，密码，评论不能为空！！！！')   ;
      return false;
   }
  }
   else
   {
   if ( isEmpty(document.add_critique.critique_content.value))
   {
      alert('评论不能为空！！！！')   ;
      return false;
   }
   }
	add_critique.ubmit.disabled =true;
	   document.add_critique.submit();
 }
//-->
</SCRIPT>
<BR><BR>
<TABLE cellSpacing=1 cellPadding=2 width=770 align=center bgColor=#cccccc 
border=0>
<TBODY>
<TR>
<TH id=white bgColor=#006699><FONT color=#ffffff>发表评论</FONT></TH></TR></TBODY></TABLE>
<TABLE cellSpacing=1 cellPadding=2 width=770 align=center bgColor=#ffffff 
border=0>
<TBODY>
<TR>
<TD>
<FORM name=add_critique action=/develop/critique_Sql.asp method=post><INPUT 
type=hidden value=add name=critique_add>
<SCRIPT>
		function getcookieval(offset)   {
		var endstr = document.cookie.indexOf(';',offset);
		if (endstr == -1)
			endstr = document.cookie.length;
		return unescape (document.cookie.substring(offset,endstr));
		}
		function getcookie(name)   {
		var arg = name + '=';
		var alen = arg.length;
		var clen = document.cookie.length;
		var j = 0;
		while (j< clen)       {
			var k = j + alen;
			if(document.cookie.substring(j,k) == arg) return getcookieval(k);
			j = document.cookie.indexOf('',j)+1;
			if (j ==0 ) break;
			}
		return null;
		}
		var ss = getcookie('userid');
		if ((ss==null) | (ss=='2')) 
		{
			document.write('<font color=red><B>你还没有登录：</B></font>昵称:<input type=text name=csdnname size=10 class=from1>　密码:<input type=password name=csdnpassword size=10 class=from1>　<a href=http://www.csdn.net/expert/zc.asp><B>免费注册</B></a>');
		}
		else
		{
			document.write('<input type=hidden name=csdnname size=10 value=><input type=hidden name=csdnpassword size=10 value=_xxx_no>')
		}
		</SCRIPT>
 <FONT color=red><B>你还没有登录：</B></FONT>昵称:<INPUT class=from1 size=10 
name=csdnname>　密码:<INPUT class=from1 type=password size=10 name=csdnpassword 
>　<A href="http://www.csdn.net/expert/zc.asp"><B>免费注册</B></A> 
&nbsp;&nbsp;评论：<BR>&nbsp;&nbsp;<BR>&nbsp;&nbsp; <INPUT onclick=javascript:submit1(); type=button value=发表评论 name=ubmit> <INPUT 
type=hidden value=24138 name=Topic_id> <INPUT type=hidden 
value=/Develop/Build_Article.asp?id=24138 name=From> 
</FORM></TD></TR></TBODY></TABLE>
<CENTER></CENTER><BR>
<HR width=770 noShade SIZE=1>

<TABLE cellSpacing=0 cellPadding=0 width=500 border=0>
<TBODY>
<TR align=center>
<TD vAlign=bottom height=10><A 
href="http://www.csdn.net/intro/intro.asp?id=2">网站简介</A> - <A 
href="http://www.csdn.net/intro/intro.asp?id=5">广告服务</A> - <A 
href="http://www.csdn.net/map/map.shtm">网站地图</A> - <A 
href="http://www.csdn.net/help/help.asp">帮助信息</A> - <A 
href="http://www.csdn.net/intro/intro.asp?id=2">联系方式</A> - <A 
href="http://www.csdn.net/english">English</A> </TD>
<TD align=center rowSpan=3><A 
href="http://www.hd315.gov.cn/beian/view.asp?bianhao=010202001032100010"><IMG 
border=0 src="biaoshi.gif" width=40 
height=48></A></TD></TR>
<TR align=center>
<TD vAlign=top>百联美达美公司 版权所有 京ICP证020026号</TD></TR>
<TR align=center>
<TD vAlign=top><FONT face=Verdana>Copyright ? CSDN.net, Inc. All rights 
reserved</FONT></TD></TR>
<TR>
<TD height=15></TD>
<TD></TD></TR></TBODY></TABLE></DIV><!--218.14.62.164//--><!--EndFragment--></BODY>
</HTML>