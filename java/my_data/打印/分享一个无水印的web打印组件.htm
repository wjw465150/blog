<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>分享一个无水印的web打印组件</title>
<meta name="GENERATOR" content="WinCHM">
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<style>
html,body { 
	/* Default Font */
	font-family: 宋体, Arial, Helvetica, sans-serif;
	font-size: 10pt;
}
</style>

</head>

<body>
<P 
style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(239,239,239); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">转自张善友大牛的博客<A 
style="COLOR: rgb(0,102,153); TEXT-DECORATION: underline" 
href="http://www.cnblogs.com/shanyou/p/3185111.html">http://www.cnblogs.com/shanyou/p/3185111.html</A></P>
<P 
style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(239,239,239); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">&nbsp; 
&nbsp; 
应用web化，不论对开发商，还是对用户来说，实在是一种很经济的选择，因为基于web的应用，客户端的规则很简单，容易学习，容易维护，容易发布。但对程序员来说，因为浏览器的局限性，却要面对很多挑战。怎么样来进行基于web的套打，就是这么一个令多数程序员头痛不已的问题。</P>
<P 
style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(239,239,239); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">&nbsp;</P>
<P 
style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(239,239,239); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">&nbsp; 
&nbsp; 
基于web的套打，难度在于要将浏览器中呈现的html，精确地打印到票据中，而且能够实现对分页位置的控制。下面就ie浏览器所能采用的套打解决方案，来个汇总分析，希望对大家有所帮助。</P>
<P 
style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(239,239,239); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">&nbsp;</P>
<P 
style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(239,239,239); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">&nbsp; 
&nbsp; jatoolsPrinter 
是一款实现网页套打的免费工具。该工具的特点是可以直接对web页面进行精确的分页打印，这不仅使“会设计网页就会做网页套打”成为可能，也使项目经理们摆脱了预算紧张的压力。jatoolsPrinter通过在网页中嵌入控件，解决了web客户端精确打印，批量打印，打印配置自动保留等问题。jatoolsPrinter 
官方正式免费版，支持ie6+，<A style="COLOR: rgb(0,102,153); TEXT-DECORATION: underline" 
href="http://printfree.jatools.com/">http://printfree.jatools.com</A>。</P>
<P 
style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(239,239,239); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">&nbsp;</P>
<P 
style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(239,239,239); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">功能特点：&nbsp;</P>
<P 
style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(239,239,239); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">真正免费，不加水印，没有ip或域名限制，不限时间，兼容ie6+&nbsp;</P>
<P 
style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(239,239,239); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">无须注册，下载即用&nbsp;</P>
<P 
style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(239,239,239); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">提供经过微软数字签名的cab自动安装包，安装更方便&nbsp;</P>
<P 
style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(239,239,239); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">长期升级保障，免费论坛支持，让你无后顾之忧&nbsp;</P>
<P 
style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(239,239,239); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">稳定可靠，启动速度远胜同类产品&nbsp;</P>
<P 
style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(239,239,239); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">常用功能集于一身，简约而不简单，软件大小只有84k</P>
<P 
style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(239,239,239); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">&nbsp;</P>
<P 
style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(239,239,239); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">&nbsp;</P>
<P 
style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(239,239,239); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">&nbsp;</P>
<P 
style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(239,239,239); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">本文主要介绍jatoolsPrinter打印控件来完成web的打印功能，这个控件已经把打印功能封装的非常好，主要是把这个控件引入，之后写一些简单的js代码就能完成相应的打印功能。</P><PRE class=csharpcode style="WORD-WRAP: break-word; MARGIN-BOTTOM: 0px; WHITE-SPACE: pre-wrap; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: black; FONT: 13px/24px consolas, 'Courier New', courier, monospace; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN class=kwrd style="COLOR: rgb(0,0,255)">&lt;!</SPAN><SPAN class=html style="COLOR: rgb(128,0,0)">DOCTYPE</SPAN> <SPAN class=attr style="COLOR: rgb(255,0,0)">html</SPAN> <SPAN class=attr style="COLOR: rgb(255,0,0)">PUBLIC</SPAN> <SPAN class=kwrd style="COLOR: rgb(0,0,255)">"-//W3C//DTD XHTML 1.0 Transitional//EN"</SPAN> <SPAN class=kwrd style="COLOR: rgb(0,0,255)">"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"</SPAN><SPAN class=kwrd style="COLOR: rgb(0,0,255)">&gt;</SPAN>
<SPAN class=kwrd style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN class=html style="COLOR: rgb(128,0,0)">html</SPAN> <SPAN class=attr style="COLOR: rgb(255,0,0)">xmlns</SPAN><SPAN class=kwrd style="COLOR: rgb(0,0,255)">="http://www.w3.org/1999/xhtml"</SPAN><SPAN class=kwrd style="COLOR: rgb(0,0,255)">&gt;</SPAN>
<SPAN class=kwrd style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN class=html style="COLOR: rgb(128,0,0)">head</SPAN> <SPAN class=attr style="COLOR: rgb(255,0,0)">runat</SPAN><SPAN class=kwrd style="COLOR: rgb(0,0,255)">="server"</SPAN><SPAN class=kwrd style="COLOR: rgb(0,0,255)">&gt;</SPAN>
    <SPAN class=kwrd style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN class=html style="COLOR: rgb(128,0,0)">title</SPAN><SPAN class=kwrd style="COLOR: rgb(0,0,255)">&gt;&lt;/</SPAN><SPAN class=html style="COLOR: rgb(128,0,0)">title</SPAN><SPAN class=kwrd style="COLOR: rgb(0,0,255)">&gt;</SPAN>
    <SPAN class=rem style="COLOR: rgb(0,128,0)">&lt;!-- 插入打印控件 --&gt;</SPAN>
    <SPAN class=kwrd style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN class=html style="COLOR: rgb(128,0,0)">object</SPAN> <SPAN class=attr style="COLOR: rgb(255,0,0)">id</SPAN><SPAN class=kwrd style="COLOR: rgb(0,0,255)">="jatoolsPrinter"</SPAN> <SPAN class=attr style="COLOR: rgb(255,0,0)">classid</SPAN><SPAN class=kwrd style="COLOR: rgb(0,0,255)">="CLSID:B43D3361-D075-4BE2-87FE-057188254255"</SPAN>
        <SPAN class=attr style="COLOR: rgb(255,0,0)">codebase</SPAN><SPAN class=kwrd style="COLOR: rgb(0,0,255)">="jatoolsPrinter.cab#version=5,7,0,0"</SPAN><SPAN class=kwrd style="COLOR: rgb(0,0,255)">&gt;</SPAN>
    <SPAN class=kwrd style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN class=html style="COLOR: rgb(128,0,0)">object</SPAN><SPAN class=kwrd style="COLOR: rgb(0,0,255)">&gt;</SPAN>
    <SPAN class=kwrd style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN class=html style="COLOR: rgb(128,0,0)">script</SPAN> <SPAN class=attr style="COLOR: rgb(255,0,0)">type</SPAN><SPAN class=kwrd style="COLOR: rgb(0,0,255)">="text/javascript"</SPAN><SPAN class=kwrd style="COLOR: rgb(0,0,255)">&gt;</SPAN>
        <SPAN class=kwrd style="COLOR: rgb(0,0,255)">function</SPAN> doPrint(how) {

            <SPAN class=rem style="COLOR: rgb(0,128,0)">//打印文档对象</SPAN>
            <SPAN class=kwrd style="COLOR: rgb(0,0,255)">var</SPAN> myDoc = {
                documents: document,    <SPAN class=rem style="COLOR: rgb(0,128,0)">// 打印页面(div)们在本文档中</SPAN>
                copyrights: <SPAN class=str style="COLOR: rgb(0,96,128)">'杰创软件拥有版权  www.jatools.com'</SPAN>         <SPAN class=rem style="COLOR: rgb(0,128,0)">// 版权声明必须</SPAN>
            };

            <SPAN class=rem style="COLOR: rgb(0,128,0)">// 调用打印方法</SPAN>
            <SPAN class=kwrd style="COLOR: rgb(0,0,255)">if</SPAN> (how == <SPAN class=str style="COLOR: rgb(0,96,128)">'打印预览...'</SPAN>)
                jatoolsPrinter.printPreview(myDoc);   <SPAN class=rem style="COLOR: rgb(0,128,0)">// 打印预览</SPAN>

            <SPAN class=kwrd style="COLOR: rgb(0,0,255)">else</SPAN> <SPAN class=kwrd style="COLOR: rgb(0,0,255)">if</SPAN> (how == <SPAN class=str style="COLOR: rgb(0,96,128)">'打印...'</SPAN>)
                jatoolsPrinter.print(myDoc, <SPAN class=kwrd style="COLOR: rgb(0,0,255)">true</SPAN>);   <SPAN class=rem style="COLOR: rgb(0,128,0)">// 打印前弹出打印设置对话框</SPAN>

            <SPAN class=kwrd style="COLOR: rgb(0,0,255)">else</SPAN>
                jatoolsPrinter.print(myDoc, <SPAN class=kwrd style="COLOR: rgb(0,0,255)">false</SPAN>);       <SPAN class=rem style="COLOR: rgb(0,128,0)">// 不弹出对话框打印</SPAN>
        }
    <SPAN class=kwrd style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN class=html style="COLOR: rgb(128,0,0)">script</SPAN><SPAN class=kwrd style="COLOR: rgb(0,0,255)">&gt;</SPAN>
<SPAN class=kwrd style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN class=html style="COLOR: rgb(128,0,0)">head</SPAN><SPAN class=kwrd style="COLOR: rgb(0,0,255)">&gt;</SPAN>
<SPAN class=kwrd style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN class=html style="COLOR: rgb(128,0,0)">body</SPAN><SPAN class=kwrd style="COLOR: rgb(0,0,255)">&gt;</SPAN>
    <SPAN class=kwrd style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN class=html style="COLOR: rgb(128,0,0)">form</SPAN> <SPAN class=attr style="COLOR: rgb(255,0,0)">id</SPAN><SPAN class=kwrd style="COLOR: rgb(0,0,255)">="form1"</SPAN> <SPAN class=attr style="COLOR: rgb(255,0,0)">runat</SPAN><SPAN class=kwrd style="COLOR: rgb(0,0,255)">="server"</SPAN><SPAN class=kwrd style="COLOR: rgb(0,0,255)">&gt;</SPAN>
    <SPAN class=kwrd style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN class=html style="COLOR: rgb(128,0,0)">div</SPAN> <SPAN class=attr style="COLOR: rgb(255,0,0)">id</SPAN><SPAN class=kwrd style="COLOR: rgb(0,0,255)">='page1'</SPAN> <SPAN class=attr style="COLOR: rgb(255,0,0)">style</SPAN><SPAN class=kwrd style="COLOR: rgb(0,0,255)">='width:300px;height:300px;'</SPAN><SPAN class=kwrd style="COLOR: rgb(0,0,255)">&gt;</SPAN>
    test
    <SPAN class=kwrd style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN class=html style="COLOR: rgb(128,0,0)">div</SPAN><SPAN class=kwrd style="COLOR: rgb(0,0,255)">&gt;</SPAN>
    <SPAN class=kwrd style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN class=html style="COLOR: rgb(128,0,0)">input</SPAN> <SPAN class=attr style="COLOR: rgb(255,0,0)">type</SPAN><SPAN class=kwrd style="COLOR: rgb(0,0,255)">="button"</SPAN> <SPAN class=attr style="COLOR: rgb(255,0,0)">value</SPAN><SPAN class=kwrd style="COLOR: rgb(0,0,255)">="打印预览..."</SPAN> <SPAN class=attr style="COLOR: rgb(255,0,0)">onclick</SPAN><SPAN class=kwrd style="COLOR: rgb(0,0,255)">="doPrint('打印预览...')"</SPAN><SPAN class=kwrd style="COLOR: rgb(0,0,255)">/&gt;</SPAN>
    <SPAN class=kwrd style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN class=html style="COLOR: rgb(128,0,0)">input</SPAN> <SPAN class=attr style="COLOR: rgb(255,0,0)">type</SPAN><SPAN class=kwrd style="COLOR: rgb(0,0,255)">="button"</SPAN> <SPAN class=attr style="COLOR: rgb(255,0,0)">value</SPAN><SPAN class=kwrd style="COLOR: rgb(0,0,255)">="打印..."</SPAN> <SPAN class=attr style="COLOR: rgb(255,0,0)">onclick</SPAN><SPAN class=kwrd style="COLOR: rgb(0,0,255)">="doPrint('打印...')"</SPAN><SPAN class=kwrd style="COLOR: rgb(0,0,255)">/&gt;</SPAN>
    <SPAN class=kwrd style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN class=html style="COLOR: rgb(128,0,0)">input</SPAN> <SPAN class=attr style="COLOR: rgb(255,0,0)">type</SPAN><SPAN class=kwrd style="COLOR: rgb(0,0,255)">="button"</SPAN> <SPAN class=attr style="COLOR: rgb(255,0,0)">value</SPAN><SPAN class=kwrd style="COLOR: rgb(0,0,255)">="打印"</SPAN> <SPAN class=attr style="COLOR: rgb(255,0,0)">onclick</SPAN><SPAN class=kwrd style="COLOR: rgb(0,0,255)">="doPrint('打印')"</SPAN><SPAN class=kwrd style="COLOR: rgb(0,0,255)">/&gt;</SPAN>
    <SPAN class=kwrd style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN class=html style="COLOR: rgb(128,0,0)">form</SPAN><SPAN class=kwrd style="COLOR: rgb(0,0,255)">&gt;</SPAN>
<SPAN class=kwrd style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN class=html style="COLOR: rgb(128,0,0)">body</SPAN><SPAN class=kwrd style="COLOR: rgb(0,0,255)">&gt;</SPAN>
<SPAN class=kwrd style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN class=html style="COLOR: rgb(128,0,0)">html</SPAN><SPAN class=kwrd style="COLOR: rgb(0,0,255)">&gt;</SPAN></PRE><PRE class=csharpcode style="WORD-WRAP: break-word; MARGIN-BOTTOM: 0px; WHITE-SPACE: pre-wrap; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: black; FONT: 13px/24px consolas, 'Courier New', courier, monospace; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN class=kwrd style="COLOR: rgb(0,0,255)"></SPAN>&nbsp;</PRE><PRE class=csharpcode style="WORD-WRAP: break-word; MARGIN-BOTTOM: 0px; WHITE-SPACE: pre-wrap; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: black; FONT: 13px/24px consolas, 'Courier New', courier, monospace; MARGIN-TOP: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><SPAN class=kwrd style="COLOR: rgb(0,0,255)"><P style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(239,239,239); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">一、引入打印控件jatoolsPrinter</P><P style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(239,239,239); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">&nbsp;</P><P style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(239,239,239); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">&lt;!-- 插入打印控件 --&gt; &lt;object id="jatoolsPrinter" classid="CLSID:B43D3361-D075-4BE2-87FE-057188254255" codebase="jatoolsPrinter.cab#version=5,7,0,0"&gt; &lt;/object&gt;</P><P style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(239,239,239); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">二、给要打印的div取id名</P><P style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(239,239,239); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">&nbsp;</P><P style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(239,239,239); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px"><BR><IMG style="BORDER-TOP: 0px; BORDER-RIGHT: 0px; BORDER-BOTTOM: 0px; BORDER-LEFT: 0px" alt="" src="http://dl2.iteye.com/upload/attachment/0089/5043/522b7312-4360-3fb3-81bc-60c7d4f9f2b9.png"><BR>&nbsp;</P><P style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(239,239,239); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">&nbsp;</P><P style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(239,239,239); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">三、编写js代码实现打印div的功能</P><P style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(239,239,239); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">&nbsp;</P><P style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(239,239,239); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">（注意：在同一页面中,有多个可打印文档,他们可以用page_div_prefix属性来区别page_div_prefix前缀+page+页序号 构成可打印div的id,如前缀为 'report1' ,则找到以 'report1page1'为id的div作为文档首页该属性,默认值为空）</P><P style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(239,239,239); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">&nbsp;</P><P style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(239,239,239); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">注意事项：</P><P style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(239,239,239); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">&nbsp;</P><P style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(239,239,239); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">1. 控件在打印指定div对象时，如果纸张太小不够打印时，超出部分将被截掉(clip)。&nbsp;</P><P style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(239,239,239); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">2. 被指定的div中的内容，可以是html任何可见对象，图片，flash，或文本等等。&nbsp;</P><P style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(239,239,239); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">3. 控件打印时，边距可设，不设则取打印机默认值。&nbsp;</P><P style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(239,239,239); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">4. div的id必须连续，如果你的div，存在 'page1'、'page2'、'page4'，而不存在'page3'，则控件只打印前两页，'page4'不会被打印。&nbsp;</P><P style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(239,239,239); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">5. div对象在页面中的位置，可以是随意的，比如，page1显示在page2后面，也是合法的。&nbsp;</P><P style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(239,239,239); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">6. 指定的div会被打印，没被指定的html元素将不会被打印，比如，本示例中的‘打印’按钮，不会被打印。&nbsp;</P><P style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; TEXT-ALIGN: left; PADDING-TOP: 0px; FONT: 14px/25px Helvetica, Tahoma, Arial, sans-serif; PADDING-LEFT: 0px; MARGIN: 0px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(239,239,239); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px">7. copyrights属性是版权信息，必须写。</P></SPAN></PRE></body>
</html>